(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){"use strict";var a=n(4);n.d(t,"getErrors",function(){return a.c}),n.d(t,"getRowErrors",function(){return a.d}),n.d(t,"getRowStatus",function(){return a.e}),n.d(t,"getUpdatedRows",function(){return a.f});var o=n(31);n.o(o,"computeAnalytic")&&n.d(t,"computeAnalytic",function(){return o.computeAnalytic}),n.o(o,"computeData")&&n.d(t,"computeData",function(){return o.computeData}),n.o(o,"computeMeta")&&n.d(t,"computeMeta",function(){return o.computeMeta}),n.o(o,"computeMetaFromData")&&n.d(t,"computeMetaFromData",function(){return o.computeMetaFromData}),n.o(o,"computeMetaPositions")&&n.d(t,"computeMetaPositions",function(){return o.computeMetaPositions}),n.o(o,"getFilters")&&n.d(t,"getFilters",function(){return o.getFilters}),n.o(o,"getSizes")&&n.d(t,"getSizes",function(){return o.getSizes}),n.o(o,"getSorts")&&n.d(t,"getSorts",function(){return o.getSorts});var r=n(12);n.d(t,"computeAnalytic",function(){return r.c}),n.d(t,"computeData",function(){return r.d});var i=n(16);n.d(t,"computeMeta",function(){return i.a}),n.d(t,"computeMetaFromData",function(){return i.b}),n.d(t,"computeMetaPositions",function(){return i.c}),n.d(t,"getSizes",function(){return i.d});var s=n(13);n.d(t,"getFilters",function(){return s.b}),n.d(t,"getSorts",function(){return s.c});n(22)},12:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return s}),n.d(t,"f",function(){return c}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return u}),n.d(t,"b",function(){return p});n(19);var a=n(2),o=n(1),r=function(e,t,n,a,r,i){var s=!(n||{}).deleted_&&e.editable_&&(t.editableFunction?t.editableFunction({column:t,row:e,status:n||{},data:a,params:r}):t.editable),c=t.select&&s&&i?t.selectItems||t.select:void 0,d="function"===typeof t.dataType?t.dataType({row:e}):t.dataType,l=t.analytic?e[t.id]:t.accessorFunction?t.accessorFunction({column:t,row:e,params:r,status:n,data:a}):e[t.id];return["date","month","year"].includes(d)&&"string"===typeof l&&(l=new Date(l)),c&&(t.selectFunction&&s&&i&&!t.selectItems&&(c=t.selectFunction({column:t,row:e,data:a,focused:i})),o.l.isPromise(c)||Array.isArray(c)||!o.l.isObject(c)||t.accessorFunction||(c=Object.values(c)),t.primaryKeyAccessorFunction&&(l={value:t.primaryKeyAccessorFunction({column:t,row:e,params:r,status:n,data:a}),caption:l})),{editable:s,select:c,value:void 0===l?null:l,dataType:d}},i=function(e,t,n,o){!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,r=[];r=t.properties.filter(function(e){return void 0!==e.accessor&&("joined object"===e.dataType&&void 0!==e.select||"object"===e.dataType&&e.hidden)});var i=t.table,s=i.pk,c=i.lk,d=i.rwd;e.forEach(function(i,l){i.index_=l+(n||0),s&&(t.indexPk[i[s.id]]=i.index_),c&&(t.indexLk[i[c.id]]=i.index_),d&&(t.indexRowId[i[d.id]]=i.index_),r.forEach(function(e){return i[e.id]=e.accessorFunction({row:i})}),o&&(e[l]=Object(a.a)({},i))})}(e,t,n,o),function(e,t){t.properties.filter(function(e){return(e.aggregation||e.analytic)&&"function"===typeof e.accessorFunction&&!e.hidden}).forEach(function(t){s(e,t)})}(e,t)},s=function(e,t){var n=e.concat([]),a=[[]];(t.sortAccessorFunction||t.groupByAccessorFunction)&&n.sort(function(e){return function(t,n){for(var a=e(t),o=e(n),r=0,i=0;!r&&i<a.length;)r=(a[i]>o[i])-(o[i]>a[i]),i++;return r}}(function(e){var n=[];return t.groupByAccessorFunction&&(n=n.concat(t.groupByAccessorFunction({row:e}))),t.sortAccessorFunction&&(n=n.concat(t.sortAccessorFunction({row:e}))),n}));var o=[];if(n.forEach(function(e,r){if(e._window={value:(t.accessorFunction||function(e){return e.row[t.accessor]})({row:e}),groupBy:t.groupByAccessorFunction?JSON.stringify(t.groupByAccessorFunction({row:e})):null},t.comparisonAccessorFunction&&(e._window.ref=t.comparisonAccessorFunction({row:e}),t.startFunction&&(e._window.start=t.startFunction(e._window.ref)),t.endFunction&&(e._window.end=t.endFunction(e._window.ref))),r>0&&e._window.groupBy!==n[r-1]._window.groupBy){if(!t.comparisonAccessorFunction){var i=t.aggregationFunction(o);a[a.length-1].forEach(function(e){return e[t.id]=i}),o=[]}a.push([])}t.comparisonAccessorFunction||o.push(e._window.value),a[a.length-1].push(e)}),t.comparisonAccessorFunction)a.forEach(function(e){return e.forEach(function(n,a){for(var o=a-1,r=[n._window.value];o>=0&&(void 0===n._window.start||e[o]._window.ref>=n._window.start);)r.push(e[o]._window.value),o--;for(o=a+1;o<e.length&&(void 0===n._window.end||e[o]._window.ref<=n._window.end);)r.push(e[o]._window.value),o++;n[t.id]=t.aggregationFunction(r)})});else{var r=t.aggregationFunction(o);a[a.length-1].forEach(function(e){return e[t.id]=r})}return e},c=function(e){return new RegExp(e.replace(" ","[".concat(String.fromCharCode(32,160),"]")),"i")},d=function(e,t){var n=(e.accessorFunction||function(t){return t.row[e.id]})({row:t});if(!o.l.isNullOrUndefined(n))return"string"===e.dataType?n.toUpperCase():"number"===e.dataType?o.l.numberToString(n):"date"===e.dataType?o.l.dateToString(n):null},l=function(e,t,n){var a=[];return e.forEach(function(e,r){if(!n[e.index_]){var i=[];t.forEach(function(t){var n=d(t,e);o.l.isNullOrUndefined(n)||i.push(n)}),n[e.index_]=i.join("~~")}a.push(n[e.index_])}),a},u=function(e,t){var n=[];return e.forEach(function(e,a){t.test(e)&&n.push(a)}),n},p=function(e,t,n){for(var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,r=a;t.length>r&&r>=0&&!n.test(d(t[r],e)||"");)r+=o;return t.length>r&&r>=0?r:null}},13:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return s});var a=n(1),o=(n(16),function(e,t,n,o){if(!e)return function(e){return e};var r=Object.values(e).concat((t||{}).filter_||[]).filter(function(e){return("boolean"!==e.dataType||null!==e.v.value)&&(!a.l.isNullOrUndefined(e.v)||"between"===e.filterType&&!a.l.isNullOrUndefined(e.vTo))}).map(function(e){return function(e,t,n,o){var r=function(r){var i=e.foreignKeyAccessorFunction||e.accessorFunction;if("status_"===e.id){var s=(o||{})[r.index_]||{};return 1*(s.updated_||0)+2*(s.new_||0)+4*(s.deleted_||0)+8*((s.errors||{n_:0}).n_>0)}i||(i="date"===e.dataType||"month"===e.dataType||"year"===e.dataType?function(e){var t=e.row,n=e.column;return new Date(t[n.id])}:function(e){return e.row[e.column.id]});var c=i({row:r,column:e,params:t,status:(o||{})[r.index_],data:n});return e.select&&null!==c&&"object"===typeof c&&!a.l.isDate(c)?c.value:c};if("date"!==e.dataType&&"month"!==e.dataType&&"year"!==e.dataType||(a.l.isNullOrUndefined(e.v)||(e.v.value=new Date(e.v.value)),a.l.isNullOrUndefined(e.vTo)||(e.vTo.value=new Date(e.vTo.value))),"status_"===e.id)e.f=function(t){var n=r(t);return n&&0!==(n&e.v)};else if("values"===e.filterType)e.f=function(t){return void 0!==e.v[r(t)]};else if("boolean"===e.dataType)e.f=function(t){return(r(t)||!1)===e.v.value};else if("="===e.filterType)e.f=function(t){return r(t)===e.v.value};else if(">="===e.filterType)e.f=function(t){return r(t)>=e.v.value};else if("between"===e.filterType)e.f=function(t){return(!!a.l.isNullOrUndefined(e.vTo)||r(t)<=e.vTo.value)&&(!!a.l.isNullOrUndefined(e.v)||r(t)>=e.v.value)};else if("<="===e.filterType)e.f=function(t){return r(t)<=e.v.value};else if("starts (case sensitive)"===e.filterType)e.f=function(t){return String(r(t)||"").startsWith(String(e.v.value||""))};else if("contains"===e.filterType)e.f=function(t){return-1!==String(r(t)||"").indexOf(String(e.v.value||""))};else if("starts"===e.filterType){var i=String(e.v.value).toUpperCase()||"";e.f=function(e){return String(r(e)||"").toUpperCase().startsWith(i)}}}(e,t,n,o),e});return r.length?function(e){return!((o||{})[e.index_]||{}).hidden_&&r.reduce(function(t,n){return t&&n.f(e)},!0)}:function(e){return!((o||{})[e.index_]||{}).hidden_}}),r=function(e,t){return e.length?e.filter(function(e){return e.v||e.vTo}).reduce(function(e,n){var o=n.v,r=n.vTo,i=n.filterType;return t[n.id]&&(o=t[n.id].v,r=t[n.id].vTo,i=t[n.id].filterType),a.l.isNullOrUndefined(o)&&("between"!==n.filterType||a.l.isNullOrUndefined(n.vTo))||(e[n.id]={id:n.id,dataType:n.dataType,filterType:i,v:o,vTo:r,accessor:n.accessor,accessorFunction:n.accessorFunction}),e},{}):t},i=function(e){return function(t,n){return e.reduce(function(e,a){var o=a.accessor||function(e){return e.row[a.id]};if(0===e){var r=o({row:t}),i=o({row:n});e=((r>i)-(i>r))*("asc"===a.direction?1:-1)}return e},0)}},s=function(e){var t=e.filter(function(e){return void 0!==e.sort}).map(function(e){var t=function(e){return a.l.nullValue(e,"")};return"number"===e.dataType||"boolean"===e.dataType?t=function(e){return a.l.nullValue(e,-1/0)}:"date"===e.dataType&&(t=function(e){return a.l.nullValue(e,new Date(null))}),{id:e.id,sortOrder:e.sortOrder,direction:e.sort,accessor:e.sortAccessorFunction||e.accessorFunction?function(n){return t(e.accessorFunction(n))}:function(n){var a=n.row;return t(a[e.id])}}});return t.sort(function(e,t){return(e.sortOrder>t.sortOrder)-(t.sortOrder>e.sortOrder)}),t}},15:function(e,t,n){"use strict";n.d(t,"e",function(){return d}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return u}),n.d(t,"b",function(){return h}),n.d(t,"f",function(){return m}),n.d(t,"a",function(){return g});var a=n(2),o=n(0),r=n.n(o),i=n(1),s=n(4),c=function(e,t){return e.functionJS=t.evalProtectedFunction(e.functionText),!0},d=function(e,t){var n=t.meta.table.rowId||t.meta.table.primaryKey;e.forEach(function(e){if(t.index){var a=t.index[e[n]];if(void 0!==a){e.index_=a;var o=t.updatedRows[a];o?o.row=e:t.data[a]=e}else t.index[e[t.meta.table.primaryKey]]=t.data.length,t.data.push(e)}else t.data.push(e)})},l=function(e){},u=function(e,t){},p=function(e){var t=e.row;return(e.status||{}).new_||t.isLocal},f=function(e,t,n){return n&&i.l.isNullValue(e)&&!i.l.isNullValue(t)?r.a.createElement("div",{style:{color:"blue"}},t):e},h={dataset:{actions:{exportMeta:function(e){return function(t){var n=t.meta,a=t.datasetFunctions,o=Object(s.a)(n,e,[{path:"../demo/dataset.functions",object:a}]);return i.l.exportFile(o,"meta.txt","text"),o}}}},properties:{accessors:{propertyType:function(e){var t=e.row,n=e.status;e.meta;return t.reference?t.reference:t.analytic?"analytic":t.accessor||(n||{}).new_?"computed":"dataset"}},sorts:{},formats:{isArrayOrFunction:function(e){var t=e.value;return"function"===typeof t||Array.isArray(t)?r.a.createElement("div",{style:{backgroundColor:"#f5f7da",fontStyle:"italic"}},Array.isArray(t)?"array[]":"fct()"):t}},aggregations:{},selects:{},validators:{row:function(e){e.row,e.status,e.data,e.params}},editables:{isDataset:function(e){return"Dataset"===e.row.tp},isNotDataset:function(e){return"Dataset"!==e.row.tp},isAnalytic:function(e){return"Analytic"===e.row.tp}},defaults:{},row:function(){},table:function(){}},functions:{accessors:{functionDescriptor:function(e){var t,n=e.row;return"accessor"===n.tp?t="Parameters: ({row,status,data,params,utils})":"editable"===n.tp?t="Parameters: ({row,status,data,params})":"select"===n.tp?t="Parameters: ({row,status,data,params})":"validator"===n.tp?t="Parameters: ({row,status,data,params})":"format"===n.tp?t="Parameters: (value,row,status,data,params)":"aggregation"===n.tp?t="Parameters: ([values])":"sort"===n.tp?t="Parameters: (rowA, rowB)":"window"===n.tp&&(t="Parameters: (value)"),"".concat(n.caption||n.id," : ").concat(t)},isLocal:p},validators:{stringToFunction:c},actions:{exportFunctions:function(e){var t=e.data;return"functions = "+Object(s.a)(t)}},editables:{isLocal:p}},dimensions:{accessors:{sortAcc:function(e){return(e.row.sort||{}).keyAccessor},sortFct:function(e){return(e.row.sort||{}).custom},isLocal:p},validators:{sortAcc:function(e){var t=e.row;return t.sort=Object(a.a)({},t.sort||{},{keyAccessor:t.sortAccessor})},sortFct:function(e){var t=e.row;return t.sort=Object(a.a)({},t.sort||{},{custom:t.sortFunction})}},editables:{isLocal:p}},measures:{accessors:{isLocal:p},editables:{isLocal:p}},globals_:{editables:{is_selected:function(e){return void 0!==e.row.index_},is_new:function(e){return e.status.new_}},observers:{onNext:d,onCompleted:l,onError:u},validators:{overwrite:function(e){return!0}}}},m=function(e,t){var n={};e.forEach(function(e){n[e.id]={id:"row.".concat(e.id),caption:"".concat(e.id),type:"property"},!t||"object"!==e.dataType&&"joined object"!==e.dataType||t.forEach(function(t){i.l.isNullValue(t[e.id])||Object.keys(t[e.id]).forEach(function(t){n[e.id+"."+t]={id:"row.".concat(e.id,".").concat(t),caption:"".concat(e.id,".").concat(t),type:"object property"}})})}),b=n},b={},g=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=function(a){return n.getFunctionsArray(e,a,t).reduce(function(e,t){return e[t.id]={id:t.id,caption:t.caption||t.id,type:"function",style:{color:"blue"}},e},{})},s=function(){var e=b,t=r("accessors");return Object(a.a)({},e,t)},d=function(){return r("formats")},l=function(){return r("validators")};return{dataset:{table:{object:"dataset",editable:!0,noFilter:!1,actions:[{type:"insert",caption:"New",enable:!0,key:"f2"},{type:"delete",caption:"Delete",enable:"is_selected",key:"f3"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4"},{type:"save",caption:"Save",enable:!0,key:"f12"},{type:"refresh",caption:"Refresh",enable:!0,key:"10"},{type:"action",enable:!0,hidden:!0,action:"toggleFilter",key:"f11"},{type:"action",caption:"Export Meta",enable:!0,action:"exportMeta"}]},row:{},properties:[]},properties:{table:{object:"properties",editable:!0,primaryKey:"id",code:"caption",noDataMutation:!0,onSave:o.applyProperties,actions:[{type:"insert",caption:"New",enable:!0,key:"f2"},{type:"delete",caption:"Delete",enable:"isNotDataset",key:"f3"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4"},{type:"action",enable:!0,hidden:!0,action:"toggleFilter",key:"f11"},{type:"save",caption:"Apply",enable:!0,key:"f12"}]},row:{},properties:[{id:"id",caption:"Column",width:100,dataType:"string",editable:"isNotDataset",mandatory:!0,locked:!0},{id:"tp",caption:"Type",width:150,dataType:"string",editable:!1,default:"Computed",accessor:"propertyType",filterType:"values"},{id:"dataType",caption:"Data type",width:100,dataType:"string",editable:"isNotDataset",filterType:"values",select:["number","string","text","date","boolean","object","joined object"]},{id:"caption",caption:"Caption",width:150,dataType:"string",editable:!0},{id:"editable",caption:"Editable",width:80,dataType:"boolean",editable:!0,default:!1},{id:"mandatory",caption:"Mandatory",width:90,dataType:"boolean",editable:!0,default:!0},{id:"hidden",caption:"Hidden",width:80,dataType:"boolean",editable:!0,default:!1},{id:"width",caption:"Width",width:60,dataType:"number",editable:!0,default:100},{id:"format",caption:"Format",width:100,dataType:"string",editable:!0,filterType:"values",select:d},{id:"filterType",caption:"Filter",width:100,dataType:"string",editable:!0,select:["starts","starts (case sensitive)","contains","=",">=","<=","between","values"]},{id:"accessor",caption:"Accessor",width:150,dataType:"string",editable:"isNotDataset",hidden:!1,filterType:"values",select:s,format:"isArrayOrFunction"},{id:"select",caption:"Select",width:100,dataType:"string",editable:!0,filterType:"values",select:function(){return r("selects")},format:"isArrayOrFunction"},{id:"default",caption:"Default",width:100,dataType:"string",editable:!0,filterType:"values",select:function(){return r("defaults")}},{id:"foreignObject",caption:"Foreign object",width:150,dataType:"string",editable:!0,select:function(){return r("foreignObjects")},format:"isArrayOrFunction"},{id:"analytic",caption:"Analytic function",width:150,dataType:"string",editable:!0,select:function(){return r("analytics")},format:"isArrayOrFunction"},{id:"onChange",caption:"On change",width:100,dataType:"string",editable:!0,filterType:"values",select:l,format:"isArrayOrFunction"},{id:"onQuit",caption:"On cell quit",width:100,dataType:"string",editable:!0,filterType:"values",select:l,format:"isArrayOrFunction"}]},functions:{table:{object:"functions",editable:!0,primaryKey:"id",code:"caption",onSave:o.applyFunctions,actions:[{type:"insert",caption:"New",enable:!0,key:"f2"},{type:"delete",caption:"Delete",enable:"isLocal",key:"f3"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4"},{type:"save",caption:"Apply",enable:!0,hidden:!o.applyFunctions,key:"f12"},{type:"action",caption:"Export functions",action:"exportFunctions",hidden:!0},{type:"action",enable:!0,hidden:!0,action:"toggleFilter",key:"f11"}]},row:{descriptor:"functionDescriptor"},properties:[{id:"id",caption:"Code",width:100,dataType:"string",editable:"isLocal",mandatory:!0,locked:!0},{id:"caption",caption:"Caption",width:150,dataType:"string",editable:!0,filterType:"between"},{id:"visibility",caption:"Visibility",width:150,dataType:"string",editable:"isLocal",select:t?[e,t,"globals_"]:[e,"globals_"],filterType:"values",mandatory:!0,default:"global"},{id:"tp",caption:"Type",width:150,dataType:"string",editable:"isLocal",filterType:"values",select:["actions","accessors","aggregations","formats","sorts","windows","selects","validators","editables","defaults","descriptors","dmls"]},{id:"isLocal",caption:"Local",accessor:"isLocal",width:80,dataType:"boolean",default:!0},{id:"functionText",caption:"Function",onQuit:function(e){var t=e.row;return c(t,n)},width:500,dataType:"text",editable:"isLocal"},{id:"functionJS",caption:"Function",hidden:!0}]},measures:{table:{object:"measures",editable:!0,primaryKey:"id",code:"caption",onSave:o.applyMeasures,actions:[{type:"insert",caption:"New",enable:!0,key:"f2"},{type:"delete",caption:"Delete",enable:"is_selected",key:"f3"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4"},{type:"save",caption:"Apply",enable:!0,key:"f12"},{type:"action",enable:!0,hidden:!0,action:"toggleFilter",key:"f11"}]},row:{},properties:[{id:"id",caption:"id",width:100,dataType:"string",editable:"isLocal",mandatory:!0},{id:"caption",caption:"caption",width:150,dataType:"string",editable:!0},{id:"valueAccessor",caption:"Value accessor",width:150,dataType:"string",editable:"isLocal",mandatory:!0,filterType:"values",select:s},{id:"localFormat",caption:"format",width:150,dataType:"string",editable:!0,filterType:"values",select:d,accessor:function(e){var t=e.row;return i.l.nullValue(t.localFormat,t.format)},onQuit:"overwrite",format:function(e){e.value;var t=e.row;return f(t.localFormat,t.format)}},{id:"aggregation",caption:"aggregation",width:150,dataType:"string",editable:"isLocal",mandatory:!0,default:"sum",filterType:"values",select:function(){return r("aggregations")}},{id:"isLocal",caption:"Local",accessor:"isLocal",width:80,dataType:"boolean",default:!0}]},dimensions:{table:{object:"dimensions",editable:!0,primaryKey:"id",code:"caption",onSave:o.applyDimensions,actions:[{type:"insert",caption:"New",enable:!0,key:"f2"},{type:"delete",caption:"Delete",enable:"is_selected",key:"f3"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4"},{type:"save",caption:"Apply",enable:!0,key:"f12"},{type:"action",enable:!0,hidden:!0,action:"toggleFilter",key:"f11"}]},row:{},properties:[{id:"id",caption:"Dimension",width:100,dataType:"string",editable:"isLocal"},{id:"caption",caption:"Caption",width:150,dataType:"string",editable:!0},{id:"keyAccessor",caption:"Key accessor",width:150,dataType:"string",editable:"isLocal",filterType:"values",select:s},{id:"localLabelAccessor",caption:"Label accessor",width:150,dataType:"string",editable:"isLocal",select:s,accessor:function(e){var t=e.row;return i.l.nullValue(t.localLabelAccessor,t.labelAccessor)},onQuit:"overwrite",format:function(e){e.value;var t=e.row;return f(t.localLabelAccessor,t.labelAccessor,!t.isLocal)}},{id:"sort",caption:"sort",width:100,dataType:"object",hidden:!0,editable:!0},{id:"localSortAccessor",caption:"Sort accessor",width:150,dataType:"string",editable:!0,filterType:"values",select:s,accessor:function(e){var t=e.row;return i.l.nullValue(t.sort.localKeyAccessor,t.sort.keyAccessor)},onQuit:function(e){var t=e.row;return t.sort||(t.sort={}),t.sort.localKeyAccessor=t.localSortAccessor,!0},format:function(e){var t=e.row;return f(t.sort.localKeyAccessor,t.sort.keyAccessor,!t.isLocal)}},{id:"localSortFunctionAccessor",caption:"Sort function",width:150,dataType:"string",editable:!0,filterType:"values",select:function(){return r("sorts")},accessor:function(e){var t=e.row;return i.l.nullValue(t.sort.localOrderFunctionAccessor,t.sort.orderFunctionAccessor)},onQuit:function(e){var t=e.row;return t.sort||(t.sort={}),t.sort.localOrderFunctionAccessor=t.localSortFunctionAccessor,!0},format:function(e){e.value;var t=e.row;return f(t.sort.localOrderFunctionAccessor,t.sort.orderFunctionAccessor,!t.isLocal)}},{id:"localFormat",caption:"format",width:150,dataType:"string",editable:!0,filterType:"values",select:d,accessor:function(e){var t=e.row;return i.l.nullValue(t.localFormat,t.format)},onQuit:"overwrite",format:function(e){e.value;var t=e.row;return f(t.localFormat,t.format,!t.isLocal)}},{id:"isLocal",caption:"Local",accessor:"isLocal",width:80,dataType:"boolean",default:!0}]}}}},16:function(e,t,n){"use strict";n.d(t,"d",function(){return o}),n.d(t,"c",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return s});var a=n(1),o=function(e,t){var n=1+!e.table.noFilter*(1+(-1!==e.properties.findIndex(function(e){return"between"===e.filterType&&!e.hidden}))),a=(e.table.caption?30:0)+n*t*e.zoom+((e.table.actions||[]).length?30:0),o=e.properties[e.properties.length-1],r=o.position+o.computedWidth;return{headersHeight:a,headersWidth:!e.table.noStatus*t*e.zoom,rowWidth:r,rowHeight:t*e.zoom}},r=function(e,t){var n=0;return e.visibleIndexes=[],e.lockedIndex=null,e.lockedWidth=null,e.properties.forEach(function(a,o){a.index_=o,a.position=n,"object"!==a.dataType&&"joined object"!==a.dataType||(a.hidden=!0),void 0!==t&&(a.computedWidth=t*(a.hidden?0:a.width||0)),0!==a.computedWidth&&(a.visibleIndex_=e.visibleIndexes.length,e.visibleIndexes.push(a.index_)),n+=a.computedWidth,a.locked&&(e.lockedIndex=a.index_,e.lockedWidth=n)}),e.visibleIndexes},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,r=0,i=e.table.object;e.promises=[],e.visibleIndexes=[],e.table.editable=e.table.editable&&!e.table.checkable,e.zoom=t,e.table.selectFunction=n.getAccessorFunction(i,"dmls",e.table.select),e.table.onTableChangeFunction=n.getAccessorFunction(i,"dmls",e.table.onTableChange),e.table.onSaveFunction=n.getAccessorFunction(i,"dmls",e.table.onSave),e.table.onSaveBeforeFunction=n.getAccessorFunction(i,"dmls",e.table.onSaveBefore),e.table.onSaveAfterFunction=n.getAccessorFunction(i,"dmls",e.table.onSaveAfter),e.indexPk||a.l.isNullValue(e.table.primaryKey)||(e.indexPk={}),e.indexLk||a.l.isNullValue(e.table.logicalKey)||(e.indexLk={}),e.indexRowId||a.l.isNullValue(e.table.rowId)||(e.indexRowId={}),e.row.descriptorFunction=n.getAccessorFunction(i,"accessors",e.row.descriptor),e.row.onQuitFunction=n.getAccessorFunction(i,"validators",e.row.onQuit),e.row.auditFunction=n.getAccessorFunction(i,"accessors",e.row.audit),e.row.editableFunction=n.getAccessorFunction(i,"editable",e.row.editable),e.table.actions&&e.table.actions.forEach(function(e){e.action&&(e.actionFunction="function"===typeof e.action?e.action:n.getAccessorFunction(i,"actions",e.action)),e.enableFunction=n.getAccessorFunction(i,"editables",e.enable)}),e.table.subscription&&(e.table.subscription.observableFunction=n.getAccessorFunction(i,"dmls",e.table.subscription.observable),e.table.subscription.observerFunctions={onNext:n.getAccessorFunction(i,"observers",(e.table.subscription.observer||{onNext:"onNext"}).onNext),onCompleted:n.getAccessorFunction(i,"observers",(e.table.subscription.observer||{onCompleted:"onCompleted"}).onCompleted),onError:n.getAccessorFunction(i,"observers",(e.table.subscription.observer||{onError:"onError"}).onError)}),e.properties.forEach(function(t,n){t.index_=n,e.config&&(t.width=e.config[t.id].width,t.locked=e.config[t.id].locked,t.index_=e.config[t.id].index_)}),e.config&&e.properties.sort(function(e,t){return(e.index_>t.index_)-(t.index_>e.index_)}),e.properties.forEach(function(o,s){o.deleted_&&(o.hidden=!0,o.mandatory=!1),"index_"===o.id&&void 0===o.hidden&&(o.hidden=!0),a.l.isNullOrUndefined(o.id)||o.id!==e.table.primaryKey||(e.table.pk=o),a.l.isNullOrUndefined(o.id)||o.id!==e.table.logicalKey||(e.table.lk=o),a.l.isNullOrUndefined(o.id)||o.id!==e.table.rowId||(o.dataType="number",o.hidden=!0,e.table.rwd=o),"object"!==o.dataType&&"joined object"!==o.dataType||(o.hidden=!0,o.referencingColumns=[]);var c=t*(o.hidden?0:o.width||0);if(o.computedWidth=c,o.position=r,r+=c,o.locked&&(e.lockedIndex=o.index_,e.lockedWidth=r),0!==c&&(o.visibleIndex_=e.visibleIndexes.length,e.visibleIndexes.push(o.index_)),e.table.editable?void 0===o.editable&&(o.editable=!0):o.editable=!1,o.editableFunction=n.getAccessorFunction(i,"editables",o.editable),o.format&&(o.formatFunction=n.getAccessorFunction(i,"formats",o.format))," "===o.select&&(o.select=void 0),o.selectFunction=n.getAccessorFunction(i,"selects",o.select),o.foreignObjectFunction=n.getAccessorFunction(i,"foreignObjects",o.foreignObject),o.accessorFunction=n.getAccessorFunction(i,"accessors",o.accessor),o.selectItems=o.select,o.selectFunction&&("function"===typeof o.selectFunction?o.selectItems=o.selectFunction({meta:e}):o.selectItems=o.selectFunction,a.l.isPromise(o.selectItems)&&(o.selectItems.then(function(e){return o.selectItems=e,(o.referencingColumns||[]).forEach(function(t){return t.selectItems=e}),e}),e.promises.push(o.selectItems))),"joined object"===o.dataType&&o.select){o.primaryKeyAccessorFunction=function(e){return e.row.pk_};var d=o.accessorFunction;o.setForeignKeyAccessorFunction=function(e){var t=e.value;e.row[o.accessor.replace("row.","")]=t},o.accessorFunction=function(e){var t=e.row,n=d({row:t});return a.l.isMap(o.selectItems)?o.selectItems.get(n):o.selectItems[n]}}if(o.onChangeFunction=n.getAccessorFunction(i,"validators",o.onChange),o.accessor&&"string"===typeof o.accessor){var l=o.accessor,u=o.accessor.indexOf(".");if(-1!==u&&"row"===l.slice(0,u)&&(u=(l=l.slice(u+1)).indexOf(".")),-1!==u){o.reference=l.slice(0,l.indexOf("."));var p=e.properties.find(function(e){return e.id===o.reference});if(p&&(o.primaryKeyAccessorFunction=n.getAccessorFunction(i,"accessors",p.accessor),o.setForeignKeyAccessorFunction=function(e){var t=e.value;e.row[p.accessor.slice(4)]=t},"joined object"===p.dataType&&(o.select=" ",p.referencingColumns.push(o),o.selectItems=p.selectItems,o.editable))){o.mandatory=o.mandatory||p.mandatory;var f=o.onChangeFunction||function(e){return!0};o.onChangeFunction=function(e){var t=e.value,n=e.row,a=e.column;return n[a.reference]=a.selectItems[t.value],n[a.id]=a.accessorFunction({column:a,row:n}),a.setForeignKeyAccessorFunction({value:t.value,row:n}),f({value:t,row:n,column:a})}}}}if(o.defaultFunction=n.getAccessorFunction(i,"defaults",o.default),o.onQuitFunction=n.getAccessorFunction(i,"validators",o.onQuit),!o.defaultFunction&&o.default&&(o.defaultFunction=function(){return"string"===typeof o.default&&"string"!==o.dataType&&"text"!==o.dataType?"boolean"===o.dataType?"true"===o.default:"number"===o.dataType&&a.l.isNumber(o.default)?Number(o.default):"date"===o.dataType&&a.l.isDate(o.default)?new Date(o.default):null:o.default}),o.analytic){var h=n.getAccessorFunction(e.table.object,"analytics",o.analytic);o.groupByAccessorFunction=n.getAccessorFunction(e.table.object,"accessors",h.groupByAccessor),o.aggregationFunction=n.getAccessorFunction(e.table.object,"aggregations",h.aggregation),h.comparisonAccessor&&(o.comparisonAccessorFunction=n.getAccessorFunction(e.table.object,"accessors",h.comparisonAccessor),o.sortAccessorFunction=n.getAccessorFunction(e.table.object,"accessors",h.sortAccessor),o.startFunction=n.getAccessorFunction(e.table.object,"windows",h.windowStart),o.endFunction=n.getAccessorFunction(e.table.object,"windows",h.windowEnd))}o.filterType&&o.filterType.startsWith("values:")&&(o.foreignKeyAccessorFunction=n.getAccessorFunction(e.table.object,"accessors",o.filterType.slice(7)),o.filterType="values"),!o.accessor||o.reference||o.onQuit||o.onChange||(o.editable=!1)}),function(e,t){if(t){var n=t&&t.children_&&t.children_.actions;e.table.actions.forEach(function(e){e.enable=n&&(t.children_.actions[e.id]||{enable:!1}).enable,e.hidden=!n||!!(t.children_.actions[e.id]||{hidden:!0}).hidden,e.enable||(e.enableFunction=function(){return!1})}),n=t&&t.children_&&t.children_.properties,e.properties.forEach(function(e){e.editable=n&&t.editable&&e.editable&&(t.children_.properties[e.id]||{editable:!1}).editable,e.hidden=!n||!!(t.children_.properties[e.id]||{hidden:!0}).hidden,e.editable||(e.editableFunction=function(){return!1})})}}(e,o)},s=function(e,t,n,o,r){var s=0;if(!t.properties.length&&e&&e.length){var c=e[0];Object.keys(c).forEach(function(e,n){var o=function(e){var t=typeof e;return"object"===t?t=a.l.isDate(e)?"date":Array.isArray(e)?"array":"object":"string"===t&&e===new Date(e).toJSON()&&(t="date"),t}(c[e]),r="",i="unset";"string"===o?i="left":"number"===o?(i="right",r="between"):"date"!==o&&"month"!==o&&"year"!==o||(i="center",r="between");t.properties.push({id:e,caption:e,tp:"Dataset",width:100,dataType:o,alignement:i,hidden:"object"===o||"joined object"===o||"array"===o||"index_"===e||"timestamp_"===e||"rowId_"===e,position:s,editable:!!t.table.editables,index_:n,formatFunction:function(e){var t=e.value;return"".concat(t)},selectFunction:void 0,filterType:r,v:null,vTo:null}),s+=100})}i(t,n,o,r)}},22:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return s});var a=n(18),o=n(1),r=n(12),i=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xls",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,d="csv"===e?",":"\t",l=Math.min(t.start.rows,t.end.rows),u=Math.max(t.start.rows,t.end.rows),p=Math.min(t.start.columns,t.end.columns),f=Math.max(t.start.columns,t.end.columns),h=[],m="",b=p;b<=f;b++)n[b].hidden||(m+=d+JSON.stringify(n[b].caption));h.push(m.slice(1));for(var g=l;g<=u;g++){var v=a[g];m="";for(var w=p;w<=f;w++){var y=n[w];if(!y.hidden){var C=Object(r.a)(v,y,i[v.index_],s,c,!0).value;o.l.isNullOrUndefined(C)?C="":"date"===y.dataType&&null!==C?C=o.l.dateToString(C,"dd/mm/yyyy"):o.l.isObject(C)&&(C=C.caption),m+=d+JSON.stringify(C)}}h.push(m.slice(1))}return h.join("\n")},s=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"xls",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=n.state.meta.properties,s=n.state.selectedRange.end,c=n.onChange,d=n.canQuit,l=n.state.filteredData,u=n.state.updatedRows,p=n.state.data,f=n.props.params,h="csv"===e?",":"\t",m=t.replace(/\r/g,"").split("\n");m.pop();var b=m.map(function(e){return e.split(h)}),g=[];b.forEach(function(e,t){var n=l[s.rows+t],a=0;e.forEach(function(e){for(var r=s.columns+a<i.length,c=i[s.columns+a];r&&c.hidden&&c.index_+1<i.length;)a++,r=s.columns+a<i.length,c=i[s.columns+a];var d={rows:s.rows+t,columns:c.index_};if(r&&c.editableFunction?c.editableFunction({column:c,row:n,status:u[n.index_]||{},data:p,params:f}):c.editable){var l=e,h=c,m=h.dataType,b=h.format;"boolean"===m?l="true"===l:"date"===m?l=o.l.stringToDate(l,b):"number"===m&&(l=""===l?null:Number(e)),d.value=l,d.columnId=c.id,g.push(d)}a++})}),g.reverse();return function e(t,o){if(!t||0===g.length)return n.isPasting=!1,void n.forceUpdate();var s=t,u=g.pop();n.isPasting=!0;var p=function(t){var n=function(t){t&&e(t,u.rows)};if(!t)return!1;r(u);var o=l[u.rows],s=i[u.columns];if(!c({value:{value:u.value},row:o,column:s}))return!1;if(o[u.columnId]=u.value,s.reference&&s.selectItems){var p=Object.values(s.selectItems).find(function(e){return s.accessorFunction({row:Object(a.a)({},s.reference,e)})===u.value});o[s.reference]=p,s.setForeignKeyAccessorFunction&&s.setForeignKeyAccessorFunction({value:p.pk_,row:o})}var f=d("cellQuit",n);void 0!==f&&n(f)};void 0!==o&&o!==u.rows&&(s=d("rowQuit",p)),void 0!==s&&p(s)}(!0,void 0),n.isPasting=!1,b}},27:function(e,t,n){},31:function(e,t){},32:function(e,t,n){e.exports=n(50)},4:function(e,t,n){"use strict";n.d(t,"j",function(){return i}),n.d(t,"l",function(){return c}),n.d(t,"k",function(){return d}),n.d(t,"e",function(){return l}),n.d(t,"f",function(){return u}),n.d(t,"m",function(){return p}),n.d(t,"i",function(){return f}),n.d(t,"d",function(){return h}),n.d(t,"c",function(){return m}),n.d(t,"b",function(){return b}),n.d(t,"a",function(){return v}),n.d(t,"g",function(){return w}),n.d(t,"h",function(){return y});var a=n(2),o=(n(0),n(1)),r=n(15),i=function(e,t){s(e,e[t])},s=function(e,t){t.new_?t.hidden_=!0:(Object.keys(t.rowUpdated).forEach(function(e){return t.rowUpdated[e]=null}),Object.keys(t.rowUpdated).forEach(function(e){return t.rowUpdated[e]=t.row[e]}));var n=t.errors&&t.errors.n_||0;t.deleted_=!1,t.updated_=!1,t.errors={},e.nErrors&&(e.nErrors-=n)},c=function(e,t){var n=Object.values(t).filter(function(e){return e.link});Object.values(e).filter(function(e){return!n.length||n.reduce(function(t,n){return t&&(e.row||e.rowUpdated)&&(e.row||e.rowUpdated)[n.id]===n.v},!0)}).forEach(function(t){return s(e,t)})},d=function(e,t){u(e).forEach(function(n){n.new_?(t.splice(n.rowUpdated.index_,1),delete e[n.rowUpdated.index_]):n.updated_&&i(e,n.row.index_)}),delete e.nErrors,delete e.nErrorsServer,e.errors={}},l=function(e,t){var n=e[t.index_];return n||(n={rowUpdated:t,row:Object(a.a)({},t),errors:{}},e[t.index_]=n),n},u=function(e){return Object.keys(e).filter(function(t){return!Number.isNaN(Number(t))&&(e[t].deleted_||e[t].new_||e[t].updated_)&&!(e[t].new_&&e[t].deleted_)}).map(function(t){return e[t]})},p=function(e,t){e[t]=!0,e.timeStamp=(new Date).getTime()},f=function(e,t,n,a,r,i,s){var c=e[t]||{};i&&(c.rowTitle=i);var d=!o.l.isNullOrUndefined(s?c.errorsServer:c.errors),l=(s?c.errorsServer:c.errors)||{},u=!o.l.isNullOrUndefined(l[n.id]),p=l[n.id]||{},f=!o.l.isNullOrUndefined(p[a]);r?(p[a]=r,f||(p.n_=(p.n_||0)+1,u||(l[n.id]=p),l.n_=(l.n_||0)+1,d||(s?c.errorsServer=l:c.errors=l),s?e.nErrorsServer=(e.nErrorsServer||0)+1:e.nErrors=(e.nErrors||0)+1)):f&&(delete p[a],p.n_--,0===p.n_&&delete l[n.id],l.n_--,s?e.nErrorsServer=(e.nErrorsServer||0)-1:e.nErrors=(e.nErrors||0)-1)},h=function(e,t){if(void 0===t)return[];var n=[];return!e.deleted_&&e.errors&&Object.keys(e.errors).forEach(function(a){(e.errors[a]||"n_"!==a)&&Object.keys(e.errors[a]).forEach(function(o){"n_"!==o&&n.push({column:a,type:o,error:e.errors[a][o],rowIndex:t})})}),!e.deleted_&&e.errorsServer&&Object.keys(e.errorsServer).forEach(function(a){(e.errorsServer[a]||"n_"!==a)&&Object.keys(e.errorsServer[a]).forEach(function(o){"n_"!==o&&n.push({column:a,type:o,error:e.errorsServer[a][o],rowIndex:t})})}),n},m=function(e){var t=[];return e.errors&&Object.keys(e.errors).forEach(function(n){e.errors[n].length&&t.push({type:n,error:e.errors[n]})}),u(e).forEach(function(e){!e.deleted_&&(e.errors||{}).n_&&(t=t.concat(h(e,e.rowUpdated.index_)))}),t},b={onTableChange:function(e){return"sort"!==e.type&&(e.modalBody="Do you want to save before ".concat(e.type,"?")),!0},onSaveBefore:function(e){var t=e.meta,n=e.updatedRows,a=t.table.lk||t.table.pk,o=m(n).map(function(e){if(void 0===e.rowIndex)return"\n".concat(t.table.caption||t.table.object," : ").concat(e.error);var o=n[e.rowIndex].rowUpdated,r=n[e.rowIndex].rowTitle;return!r&&a&&(r="".concat(a.caption," ").concat(o[a.id])),"\n".concat(r," : ").concat(e.error)});return o.length?(e.modalBody=["Can't save with errors: "].concat(o),!1):(e.modalBody=null,!0)},onSave:function(e){return!e.serverError||(e.modalBody=e.serverError,!1)}},g={visibleIndexes:!0,selectItems:!0,selectFilter:!0,position:!0,index_:!0,visibleIndex_:!0},v=function(e,t,n){var a=JSON.stringify(function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;return Array.isArray(t)?t.map(function(t){return e(t,n)}):"object"===typeof t?Object.keys(t).reduce(function(a,r){return o.l.isNullOrUndefined(t[r])||n[r]||(a[r]=e(t[r],n)),a},{}):t}(e,{serverPagination:!0,zoom:!0,indexRowId:!0,computedWidth:!0,rwd:!0,tp:!0,visibleIndexes:!0,statusDraggable:!0,visibleIndex_:!0,index_:!0,position:!0})),i=[],s=[],c={},d=[{path:"zebulon-controls",object:o.h},{path:"../MetaDescriptions",object:r.b}].concat(n||[]);d.forEach(function(e){return e.functions=o.j.functions([e.object])}),d.reverse();var l={},u=Object.keys(t).reduce(function(e,n){return e[n]=Object.keys(t[n]).reduce(function(e,a){return e[a]=Object.keys(t[n][a]).reduce(function(e,o){if("analytics"===a);else{var r=t[n][a][o],u=r.f.name||o,p=u;if(!r.fText&&!s.includes(r.f))c[u]=void 0===c[u]?0:c[u]+1,c[u]&&(p="".concat(u,"_").concat(c[u])),d.reduce(function(e,t){if(e)return!0;var r=t.functions.getFunction(n,a,o);return r&&(l[t.path]||(l[t.path]=[]),l[t.path].push(o!==p?o+" as "+p:o)),!!r},!1)||i.push("const ".concat(p,"=").concat(r.f.toString(),";")),s.push(r.f);e[o]="~~~".concat(r.fText||p,"~~~")}return e},{}),e},{}),e},{});return Object.keys(l).map(function(e){return"// import {".concat(l[e].join(","),'} from "').concat(e,'";\n')}).join(" ")+"userMeta={meta: "+a+",functions : "+JSON.stringify(u).replace(/"~~~/g,"").replace(/~~~"/g,"").replace(/\\"/g,'"')+"};"+i.join(" ").replace(/\\n/g,"").replace(/\\t/g,"")},w=function e(t,n){return!!t.parentElement&&(t.parentElement.id.slice(0,n.length)===n||e(t.parentElement,n))},y=function e(t,n){return!!(t===n||o.l.isDate(t)&&o.l.isDate(n)&&t.getTime()===n.getTime()||o.l.isDate(t)&&"string"===typeof n&&t.getTime()===new Date(n).getTime()||o.l.isDate(n)&&"string"===typeof t&&n.getTime()===new Date(t).getTime()||"object"===typeof t&&"object"===typeof n&&Object.keys(t).length===Object.keys(n).length&&Object.keys(t).reduce(function(a,o){return a&&e(t[o],n[o])}))}},50:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(23),i=n.n(r),s=n(6),c=n(11),d=n(8),l=n(7),u=n(9),p=(n(37),n(27),n(1)),f=n(2),h=n(19),m=n(5),b=n(16),g=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).handleAudit=function(e,t){var a=e.status,o=a.row||a.rowUpdated,r=n.state.meta.row.auditFunction({row:o});p.l.isPromise(r)?(n.setState({status:{loaded:!1,loading:!0}}),r.then(function(e){n.setState({auditedRow:o,audits:e||[],status:{loaded:!0,loading:!1}}),n.props.onRowEnter&&n.props.onRowEnter({audited:!0,row:(e||[])[0]})})):(n.setState({auditedRow:o,audits:r||[],status:{loaded:!0,loading:!1}}),n.props.onRowEnter&&n.props.onRowEnter({audited:!0,row:(r||[])[0]})),n.table.handleClickMenu(e,t)},n.handleCloseAudit=function(e,t){n.setState({auditedRow:void 0,audits:void 0}),n.props.linkedObjects&&n.props.linkedObjects.forEach(function(e){return e.setState({auditedRow:void 0,audits:void 0})}),n.table.handleClickMenu(e,t)},n.handleRollback=function(e,t){n.rollback(n.state.updatedRows,e.row.index_),n.table.handleClickMenu(e,t)},n.getCustomMenu=function(e,t){n.props.contextualMenu&&n.props.contextualMenu[e]&&n.props.contextualMenu[e].forEach(function(e,a){e.id||t.length;var o=e.children||("sub-menu"===e.type?[]:void 0),r=Object(f.a)({},e,{id:e.id||1e6+t.length,children:o});r.onClick=function(t){return(e.onClick||n.handleClickMenu)(t,r)},t.push(r)})},n.getMenu=function(e,t){var a=[];if(!n.props.isActive&&n.props.onActivation&&n.props.onActivation(n.props.componentId||"zebulon-table-".concat(n.props.id)),"row-header-menu"===e)n.state.meta.table.editable&&a.push({id:a.length,type:"menu-item",disable:!(t.status||{}).updated_,separation:!1,caption:"Rollback row updates",onClick:n.handleRollback}),n.state.meta.row.audit&&a.push({id:a.length,type:"menu-item",disable:void 0!==n.state.auditedRow,caption:"Audit",onClick:n.handleAudit});else if("column-header-menu"===e)a.push({id:a.length,type:"menu-item",disable:p.l.isNullOrUndefined(n.table.state.meta.lockedIndex),separation:!1,caption:"Unlock columns",onClick:n.table.handleClickMenu}),a.push({id:a.length,type:"menu-item",separation:!1,caption:"Lock columns until ".concat(t.column.caption),onClick:n.table.handleClickMenu});else if("top-left-corner-menu"===e){if(n.state.meta.table.editable){a.push({id:a.length,type:"menu-item",checked:void 0===n.table.state.filters.status_,caption:"No status filter",onClick:n.table.handleClickMenu});var o=function(e){return(e|(n.table.state.filters.status_||{v:0}).v)===(n.table.state.filters.status_||{v:0}).v};a.push({id:a.length,type:"sub-menu",separation:a.length>0,caption:"Status filters",children:[{id:101,type:"menu-item",checked:o(1),separation:!1,caption:"Updated rows",onClick:n.table.handleClickMenu},{id:102,type:"menu-item",checked:o(2),separation:!1,caption:"New rows",onClick:n.table.handleClickMenu},{id:104,type:"menu-item",checked:o(4),separation:!1,caption:"Deleted rows",onClick:n.table.handleClickMenu},{id:108,type:"menu-item",checked:o(8),separation:!1,caption:"Rows with errors",onClick:n.table.handleClickMenu}]})}n.state.meta.row.audit&&a.push({id:a.length,type:"menu-item",disable:void 0===n.state.auditedRow,separation:n.state.meta.table.editable,caption:"Close audit",onClick:n.handleCloseAudit})}return n.getCustomMenu(e,a),a.length?{type:"menu",position:"bottom",children:a}:null},n}return Object(u.a)(t,e),t}(a.Component),v=n(12),w=n(4),y=n(17),C=n.n(y),S=n(14);console.log(S.e);var k=function(e,t,n,a,r,i,s,c){var d=C()({"zebulon-table-cell":!0,"zebulon-table-header":!0,"zebulon-table-filter":!0,"zebulon-table-filter-checkbox":"boolean"===e.dataType,"zebulon-table-filter-checkbox-undefined":"boolean"===e.dataType&&(!e.v||null===e.v.value)}),l=e.alignement||"left";e.alignement||("number"===e.dataType?l="right":"date"!==e.dataType&&"month"!==e.dataType&&"year"!==e.dataType&&"boolean"!==e.dataType||(l="center"));var u,f="filter".concat(r?"To":"",": ").concat(c,"--").concat(e.index_),h=(document.activeElement||{}).id===f,m=e.v;return"values"===e.filterType&&e.v?u=o.a.createElement("div",{style:{height:n,width:a},id:f,key:f,className:d,onClick:function(t){return s(t,e)}},o.a.createElement(S.e,null)):(r?m=e.vTo:"values"===e.filterType&&(m=""),u=o.a.createElement(p.f,{column:e,id:f+"-",key:f,className:d,style:{height:n,width:a,textAlign:l},editable:!0,focused:h,inputType:"filter",tabIndex:2*e.index_+(r||0)+100,value:void 0===m?{caption:""}:m,filterTo:r,onChange:i,onFocus:function(t){s(t,e)}})),u},T=function(e,t,n,a,r,i,s,c,d){var l=function(){return null};"asc"===e.sort?l=S.c:"desc"===e.sort&&(l=S.b);var u="header: ".concat(d,"--").concat(e.index_);return o.a.createElement(p.c,{key:u,id:u,className:"zebulon-table-cell zebulon-table-header",onClick:function(){return r(e,!1)},onDoubleClick:function(){return r(e,!0)},onDragOver:s,onDrop:c,style:{height:n,width:a,justifyContent:"space-between",display:"flex",paddingRight:"unset"},column:e,menu:"column-header-menu",componentId:d},o.a.createElement("div",{id:u,key:0,style:{width:a-15},draggable:!0,onDragStart:function(e){return i(e,"move")}},e.caption||e.id),o.a.createElement(l,null),o.a.createElement("div",{id:u,key:2,style:{width:6,cursor:"col-resize",opacity:0},draggable:!0,onDragStart:function(e){return i(e,"resize")}}))},x=function(e,t,n,a,r,i,s){var c=Object(v.a)(e,t,n,a,r,!1).value,d=t.alignement||"left";t.alignement||("number"===t.dataType?d="right":"date"!==t.dataType&&"month"!==t.dataType&&"year"!==t.dataType&&"boolean"!==t.dataType||(d="center")),i.textAlign=d;var l=C()({"zebulon-table-cell":!0,"zebulon-table-cell-audit":!0,"zebulon-table-cell-odd":!0}),u="audit-cell: ".concat(s,"-").concat(e.index_,"-").concat(t.index_);return o.a.createElement(p.f,{row:e,column:t,style:i,className:l,value:c,key:u,id:u})},O=function(e,t,n,a){return o.a.createElement("div",{key:"".concat(e,"-filter-empty"),className:"zebulon-table-cell zebulon-table-header zebulon-table-filter-empty",style:{height:a,width:n}})},_=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).handleClick=function(e,t){!n.props.isActive&&n.props.onActivation&&n.props.onActivation(n.props.componentId);var a=n.props.onSort;t?(clearTimeout(n.timer),n.prevent=!0,a(e,!0)):n.timer=setTimeout(function(){n.prevent||a(e,!1),n.prevent=!1},200)},n.getColumnIndex=function(e){var t=e.split("-");return t[t.length-1]},n.handleDragStart=function(e,t){n.dragId=e.target.id,n.dragType=t,n.dragX=e.pageX,e.dataTransfer.setData("text",n.dragId),e.stopPropagation()},n.handleDragOver=function(e){("move"===n.dragType||"resize"===n.dragType&&n.props.meta.properties[n.getColumnIndex(n.dragId)].computedWidth+e.pageX-n.dragX>20)&&e.preventDefault()},n.handleDrop=function(e){e.preventDefault();var t=n.props.meta.properties;if(n.dragType)if("move"!==n.dragType||p.l.isNullOrUndefined(n.dragId)||n.dragId===e.target.id){if("resize"===n.dragType&&!p.l.isNullOrUndefined(n.dragX)&&!p.l.isNullOrUndefined(e.pageX)){var a=t[n.getColumnIndex(n.dragId)],o=a.computedWidth/a.width;a.computedWidth+=e.pageX-n.dragX,a.width=a.computedWidth/o,Object(b.c)(n.props.meta),n.props.onMetaChange()}}else t[n.getColumnIndex(n.dragId)].index_=t[n.getColumnIndex(e.target.id)].index_+.1,t.sort(function(e,t){return e.index_-t.index_}),Object(b.c)(n.props.meta),n.props.onMetaChange();n.dragId=null,n.dragType=null,n.dragX=null},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"shouldComponentUpdate",value:function(){return!this.props.changingFilter}},{key:"render",value:function(){var e=this.props.scroll,t=e.shift,n=e.startIndex,a=this.props,r=a.meta,i=a.width,s=a.height,c=a.onChange,d=a.openFilter,l=a.headersLength,u=a.locked,h=a.auditedRow,m=a.auditStatus,b=a.componentId,g=a.id,v=a.data,w=a.params,y=[],C=0,S=!0;for(u?(n=0,t=0):n=Math.max(n,p.l.isNullOrUndefined(r.lockedIndex)?0:r.lockedIndex+1);n<r.properties.length&&C<i;){var _=r.properties[n],I=Math.max(Math.min(S?_.computedWidth+t:_.computedWidth,i-C),0),E=null;if(!_.hidden&&I){if(S=!1,E=T(_,0,s/l,I,this.handleClick,this.handleDragStart,this.handleDragOver,this.handleDrop,b||g),l>1){if(h)(E=[E]).push(x(h,_,m,v,w,{width:I,height:s/2},b||g));else E=[E],["object","array","function","text"].includes(p.l.nullValue(_.dataType,"object"))?E.push(O(_.id,0,I,s/l)):E.push(k(_,0,s/l,I,!1,c,d,b)),3===l&&("between"!==_.filterType||["object","array","function","text"].includes(p.l.nullValue(_.dataType,"object"))?E.push(O("".concat(_.id,"-to"),0,I,s/l)):E.push(k(_,0,s/l,I,"between"===_.filterType,c,d,b)));E=o.a.createElement("div",{key:_.id||"undefined ".concat(_.index_),style:{left:C,display:"block",width:I,height:s}},E)}y.push(E),C+=I}n+=1}var F={width:i,height:s,display:"flex"};return u||(F.overflow="hidden"),y.length?o.a.createElement("div",{id:"tutut",key:-2-u,className:u?"zebulon-locked-headers":"",style:Object(f.a)({},this.props.style,F,{position:"relative"})},y):null}}]),t}(a.Component),I=function(e,t,n,a,r,i,s,c,d,l,u,f,h,m){var b=function(){return null};a.deleted_?b=S.j:a.new_?b=S.f:a.updated_&&(b=S.d);var g=Object(w.d)(a,a.rowUpdated.index_),v=g.length&&!a.deleted?{color:"red"}:{};d&&(b=function(){return o.a.createElement("input",{type:"checkbox",checked:l||!1,onChange:function(){return u(a.rowUpdated.index_)}})});var y="status: ".concat(c,"-").concat(n,"-");return o.a.createElement(p.c,{id:y,key:y,index:n,className:t,style:e,onClick:function(e){return r(n,e.shiftKey)},onMouseOver:function(e){return s(e,g)},onMouseOut:function(e){return s(e,[])},onDoubleClick:i?function(e){return i(e,a.rowUpdated)}:function(){},draggable:h,onDragStart:m,status:a,menu:"row-header-menu",componentId:c},o.a.createElement(b,{style:v,id:y}))},E=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).onClick=function(e,t){var a=n.props,o=a.meta,r=a.scroll,i=(o.visibleIndexes||[0])[0],s=t?n.props.selectedIndex:e;n.props.selectRange({end:{rows:e,columns:i},start:{rows:s,columns:o.properties.length-1}},void 0,void 0,void 0,!1,e===r.startIndex||e===n.stopIndex)},n.onChange=function(e){if(n.props.checkable){var t=n.props.updatedRows,a=!t[e].rowUpdated.checked_;t[e].rowUpdated.checked_=a,2===n.props.checkable&&(t[e+1-e%2*2].rowUpdated.checked_=!a)}},n.handleDragStart=function(e){e.stopPropagation(),e.dataTransfer.setData("text","status: ".concat(e.target.id))},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"shouldComponentUpdate",value:function(e){return!e.status.loadingPage&&!e.noUpdate}},{key:"render",value:function(){var e=this,t=this.props,n=t.height,a=t.rowHeight,r=t.data,i=t.scroll,s=t.selectedIndex,c=t.handleErrors,d=t.dataLength,l=t.componentId,u=t.checkable,p=t.onDoubleClick,f=(t.isAudit,t.draggable),h=(t.statusChanged,this.props.updatedRows),m=0,b=0,g=r;"object"===typeof r&&r.page&&(g=r.page,b=r.pageStartIndex);for(var v=[];m<Math.min(d||r.length,Math.ceil(n/a));){var y={top:0===m?0:i.shift+m*a,width:a,height:0===m?a+i.shift:Math.min(a,n-(i.shift+m*a))};m+i.startIndex-b<g.length&&function(){var t=g[m+i.startIndex-b],n=Object(w.e)(h,t),a=C()({"zebulon-table-status":!0,"zebulon-table-status-selected":s===m+i.startIndex}),o=m;v.push(I(y,a,o+i.startIndex,n,e.onClick,p,function(e,t){return c(e,o,t)},l,u,t.checked_,e.onChange,0,f))}(),m+=1}return this.stopIndex=m+i.startIndex-1,o.a.createElement("div",{key:"status: "+l,id:"status: "+l,style:{width:a,height:n,position:"relative",diplay:"flex"}},v)}}]),t}(a.Component),F=n(18),A=n(22),j=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).closeOpenedWindows=function(e,t,a){n.state.openedFilter&&n.setState({openedFilter:void 0}),void 0===n.state.text.top||t&&"text"===t.dataType||n.setState({text:{}}),void 0!==n.state.detail.content&&n.setState({detail:{}}),void 0!==n.state.toolTip&&n.setState({toolTip:void 0}),e||void 0===n.state.search||n.setState({search:void 0}),n.props.contextualMenu&&n.props.contextualMenu.close()},n.fKeyMap={f12:"save",f11:"filter",f10:"refresh"},n.toggleFilter=function(){if(n.hasFocus){var e=document.getElementById("filter: ".concat(n.props.id,"--").concat(n.state.selectedRange.end.columns));e&&e.children[0]&&(e.children[0].focus(),n.hasFocus=!1)}else document.activeElement.blur(),n.hasFocus=!0,n.setState({selectedRange:n.state.selectedRange})},n.handleKeyDown=function(e){var t=e.which||e.keyCode,a=p.l.keyMap[t];if(void 0!==a){var o=n.state,r=o.openedFilter,i=o.detail,s=Object(w.g)(document.activeElement,"filter");if("Escape"===a&&(r&&(n.hasFocus=!0),n.closeOpenedWindows()),"Tab"===a&&(r||i.content||s))return n.hasFocus=!1,!1;if("Enter"===a&&n.column&&n.row&&n.column.foreignObjectFunction)return n.foreignObject("none",{row:n.row,column:n.column,value:void 0!==n.row[n.column.id]?n.row[n.column.id]:n.column.accessorFunction({row:n.row}),id:n.props.componentId}),e.preventDefault(),!1;if(t>112&&t<124){var c=n.state.meta.table.actions.find(function(e){return e.key===a});c&&(e.preventDefault(),n.handleAction(c))}if(70===(e.which||e.keyCode)&&e.ctrlKey)n.hasFocus=!1,n.handleSearch(e);else if("Space"===a&&n.hasFocus&&"boolean"===n.column.dataType&&document.activeElement.id!=="cell: ".concat(n.props.componentId||n.props.id,"-").concat(n.row.index_,"-").concat(n.column.index_))e.preventDefault(),n.onChange({row:n.row,column:n.column,value:{value:!n.row[n.column.id]}});else if(p.l.isNavigationKey(e)){if(r)return"Enter"===a?(e.preventDefault(),n.hasFocus=!0,n.openedFilter.onOk()):n.openedFilter.values.handleNavigationKeys(e);if(s&&["ArrowLeft","ArrowRight"].includes(a))return!1;if(n.rows)return n.rows.handleNavigationKeys(e)}console.log("te",a,e.defaultPrevented,n.state.meta)}},n.copy=function(e){try{navigator.clipboard.writeText(e).then(function(e){return console.log(e)})}catch(t){console.error("error during copy",t)}},n.handleCopy=function(e){e.target.selectionStart===e.target.selectionEnd&&(e.preventDefault(),n.copy(Object(A.b)("xls",n.state.selectedRange,n.state.meta.properties,n.state.filteredData,n.state.updatedRows,n.state.data,n.props.params)))},n.handlePaste=function(e){var t=e.clipboardData.getData("text");if(t.includes("\r"))return e.preventDefault(),Object(A.a)("xls",t,Object(m.a)(Object(m.a)(n)),function(e){return n.selectRange_({start:e,end:e},function(e){return e},void 0,"enter")})},n.handleSearch=function(e){e.preventDefault(),n.setState({search:!0})},n.getDetail=function(e){var t=e.Detail,n=e.row,a=e.data,r=e.meta,i=e.status,s=e.params,c=e.top,d=e.onClose,l=e.onChange;return o.a.createElement(t,{row:n,data:a,meta:r,params:s,status:i,onChange:l,close:d,top:c})},n.onDoubleClick=function(e,t,a){n.props.onDoubleClick?n.props.onDoubleClick(t,a):n.doubleClickAction&&n.handleAction(n.doubleClickAction,e,t,a)},n.onFocus=function(e,t,a){n.closeOpenedWindows(!0,a)},n.handleToolTip=function(e,t,a){if("svg"===t.target.tagName&&(!t.relatedTarget||!t.relatedTarget.parentElement||t.relatedTarget.parentElement.id!==t.target.id))if(a)n.state.toolTip?(console.log("tooltip2",t.target.tagName,t.target.id,t.relatedTarget.parentElement.id,n.state.toolTip),n.setState({toolTip:null}),n.toolTipTimer=void 0):n.toolTipTimer&&(clearTimeout(n.toolTipTimer),n.toolTipTimer=void 0);else if(e.toolTip){var o={type:"text",top:20,left:t.target.parentElement.offsetLeft+(1+parseInt(t.target.id))*(t.target.clientWidth+10)-15,content:"function"===typeof e.toolTip?e.toolTip(t):e.toolTip};n.toolTipTimer=setTimeout(function(){n.setState({toolTip:o}),n.toolTipTimer=void 0},500),console.log("tooltip",t.target.tagName,t.target.id,t.relatedTarget.parentElement.id,o)}},n.handleAction=function(e,t,a,o){if(!1===e.statusEnable||!1===e.enable)return!1;n.closeOpenedWindows();var r=n.state.selectedRange.end.rows;if(a||void 0===r||(a=n.getRow(r)),n.state.selectedRange||"delete"!==e.type&&"select"!==e.type){if("delete"===e.type)return n.handleDelete(a);if("insert"===e.type)return n.handleNew(r||0);if("duplicate"===e.type)return n.handleDuplicate(r||0);if("save"===e.type)return n.props.onSave();if("refresh"===e.type)n.props.onTableChange("refresh");else if("detail"===e.type&&e.content)n.setState({detail:e});else if(e.action||"action"===e.type&&n.props.onAction){var i=n.state,s=i.selectedRange,c=i.updatedRows,d=i.data,l=i.meta,u=i.filters,p=function(){var r;return(n.props.onAction||e.actionFunction||function(){})((r={action:e,row:a||n.row,column:o,selectedRange:s,updatedRows:c,filters:u,data:d,meta:l,params:n.props.params},Object(F.a)(r,"action",e),Object(F.a)(r,"ref",Object(m.a)(Object(m.a)(n))),r),t)};e.onTableChange?n.props.onTableChange(e.onTableChange,function(e){e&&p()}):p(),n.setState({status:n.state.status})}}},n.handleDelete=function(e){var t=Object(w.e)(n.state.updatedRows,e);if(t.deleted_?t.deleted_=!1:(t.new_||Object(w.j)(n.state.updatedRows,e.index_),Object(w.m)(t,"deleted_")),n.setState({status:n.state.status}),n.props.onRowDelete){var a={row:e,status:t,meta:n.state.meta,data:n.state.data,params:n.props.params};n.props.onRowDelete(a)}},n.newRow=function(e,t){n.canQuit("new",function(a){a&&n.newRow_(e,t)})&&n.newRow_(e,t)},n.newRow_=function(e,t){var a=n.state,o=a.selectedRange,r=a.updatedRows,i=a.filteredData,s=a.meta,c=a.data,d=a.scroll,l={new_:!0,errors:{},rowUpdated:e,timeStamp:(new Date).getTime()};n.state.meta.table.rowId&&(e[n.state.meta.table.rowId]=void 0),n.state.meta.table.primaryKey&&(e[n.state.meta.table.primaryKey]=null);var u=i,p=t;if(r[n.getDataLength()]=l,s.serverPagination?(u=i.page,p=t-i.pageStartIndex,i.pageLength++,i.filteredDataLength++,i.dataLength++):(u=i,c.push(e)),u.splice(p,0,e),s.serverPagination?(i.page=u,n.setState({filteredData:i})):n.setState({filteredData:u}),n.onRowNew(e)){var f=(s.visibleIndexes||[0])[0],h={end:{rows:o.end.rows||0,columns:f},start:{rows:o.end.rows,columns:s.properties.length-1}},m=Math.sign(h.end.rows-(d.rows.startIndex||0)),b=Math.sign(h.end.columns-d.columns.startIndex);n.selectRange(h,void 0,e,"enter",!1),n.rowUpdated=!0,n.scrollTo(h.end.rows,m,h.end.columns,b)}},n.handleNew=function(e){var t={index_:n.getDataLength()};n.state.meta.properties.filter(function(e){return e.defaultFunction}).forEach(function(e){return t[e.id]=e.defaultFunction({column:e,row:t,params:n.props.params})}),n.newRow(t,e)},n.handleDuplicate=function(e){if(n.row){var t=Object(f.a)({},n.row,{index_:n.getDataLength()});n.newRow(t,e)}},n.pagination=function(e){var t=e.startIndex,a=e.stopIndex,o=e.callbackBefore,r=e.callbackAfter,i=e.filters,s=e.sorts,c=n.state,d=c.updatedRows,l=c.filteredData,u=c.meta;n.setState({status:{loaded:!1,loading:!1,loadingPage:!0}}),n.state.data({startIndex:t,stopIndex:a,filters:i,sorts:s,updatedRows:d}).then(function(e){o&&o(e),l.page=e.page,l.pageLength=e.pageLength,l.filteredDataLength=e.filteredDataLength,l.pageStartIndex=e.pageStartIndex,Object(v.d)(e.page,u,0),n.props.onGetPage&&n.props.onGetPage(e),r&&r(e),n.setState({filteredDataLength:l.filteredDataLength,status:{loaded:!0,loading:!1,loadingPage:!1}})})},n.getDataLength=function(){return n.state.meta.serverPagination?n.state.filteredData.dataLength:n.state.data.length},n.getFilteredDataLength=function(){return n.state.meta.serverPagination?n.state.filteredData.filteredDataLength:n.state.filteredData.length},n.getRow=function(e){var t=n.state.filteredData;return n.state.meta.serverPagination?t.page[e-t.pageStartIndex]||{index_:void 0}:t[e]||{index_:void 0}},n.isInPage=function(e){return!n.state.meta.serverPagination||e.startIndex>=n.state.filteredData.pageStartIndex&&e.startIndex+Math.ceil(n.rowsHeight/n.rowHeight)-1<n.state.filteredData.pageStartIndex+n.state.filteredData.pageLength},n.paginationIsRequired=function(e){var t=e.startIndex,a=e.stopIndex;return n.state.meta.serverPagination&&(t<n.state.filteredData.pageStartIndex||a>=n.state.filteredData.pageStartIndex+n.state.filteredData.pageLength)},n.scrollTo=function(e,t,a,o,r,i){n.rows&&(t||o)&&n.rows.scrollOnKey({rows:e,columns:a},null,t,o,!1,i),r&&(n.hasFocus=!1)},n.onScroll=function(e,t,a){var o=e.rows.startIndex,r=o+Math.ceil(n.rowsHeight/n.rowHeight)-1;n.paginationIsRequired({startIndex:o,stopIndex:r})?n.pagination({startIndex:o,stopIndex:r,callbackAfter:function(){return n.onScroll_(e,t,a)}}):n.onScroll_(e,t,a)},n.onScroll_=function(e,t,a){n.closeOpenedWindows(!0);var o=Object(f.a)({},n.state.selectedRange);t&&(o.end=t,a||(o.start=t),n.selectRange_(o,function(e){return e})),n.setState({scroll:e})},n.selectRange=function(e,t,a,o,r,i){if(!n.state.status.loadingPage&&!n.state.status.loading){var s=e.end.rows,c=e.end.rows;if(n.paginationIsRequired({startIndex:s,stopIndex:c}))n.pagination({startIndex:s,stopIndex:c,callbackAfter:function(){return n.selectRange_(e,t||function(e){return e},a,o,r,i)}});else{n.closeOpenedWindows(!0);var d=n.selectRange_(e,t||function(e){return e},a,o,r,i);if(void 0!==d)return t?t(d):d}}},n.selectRange_=function(e,t,a,o,r,i){void 0!==r&&(n.hasFocus=!r),!n.props.isActive&&n.props.onActivation&&void 0!==r&&n.props.onActivation(n.props.componentId||n.props.id);var s=n.state,c=s.selectedRange,d=(s.scroll,n.state.meta),l=c.end,u=c.start,h=l.rows!==e.end.rows||l.columns!==e.end.columns,m=function(r){return r?((h||o)&&(l.rows===e.end.rows&&"enter"!==o||(n.rowUpdated=!1,void 0!==e.end.rows?(n.row=a||n.getRow(e.end.rows),n.previousRow=Object(f.a)({},n.row)):(n.row=void 0,n.previousRow=void 0)),n.updated=!1,void 0!==e.end.rows?(n.column=d.properties[e.end.columns],n.previousValue=n.row[n.column.id],l.rows===e.end.rows&&"enter"!==o||n.onRowEnter(n.row),n.onCellEnter(n.previousValue,n.row,n.column),"text"===d.properties[e.end.columns].dataType&&n.handleText(e.end,n.row,n.column),i&&n.rows.scrollOnKey({rows:e.end.rows,columns:e.end.columns},p.i.AxisType.ROWS)):(n.column=void 0,n.previousValue=void 0)),(h||u.rows!==e.start.rows||u.columns!==e.start.columns)&&n.setState({selectedRange:e}),n.range=e,t(!0),!0):(t(!1),!1)};return"enter"!==o&&h?function(){var t=l.rows!==e.end.rows||a?"rowQuit":"cellQuit",o=n.canQuit(t,m);if(void 0!==o)return m(o)}():m(!0)},n.onChange=function(e){var t=e.value,a=e.row,o=e.column;n.updated=!0,n.rowUpdated=!0,n.tableUpdated=!0;var r=n.state,i=r.updatedRows,s=r.data,c=r.meta;delete r.dataStrings[a.index_];var d=Object(w.e)(i,a);d.updated_||(Object(w.m)(d,"updated_"),n.setState({statusChanged:!n.state.statusChanged})),o.items=void 0;var l={value:t,previousValue:n.previousValue,row:a,status:d,column:o,meta:c,data:s,params:n.props.params};return n.onChange_(l)&&n.props.errorHandler(l,"onChange")},n.onChange_=function(e){var t=e.row,a=e.column,o=e.value;return t[a.id]=o.value,!(!a.foreignObjectFunction&&a.onChangeFunction&&!1===a.onChangeFunction(e))&&(!n.props.onChange||!1!==n.props.onChange(e))},n.onCellQuit=function(e){return n.onCellQuit_(e,e.callback)},n.foreignObject=function(e,t){var a=t.id,o=t.value,r=t.column,i=t.row,s=t.cellQuit,c=document.activeElement,d=r.foreignColumn||"cd",l=Object(F.a)({},d,{id:d,filterType:"starts",v:{value:o}});n.props.onForeignKey(r.foreignObjectFunction,l,e,function(e,t){return e?r.onChangeFunction?r.onChangeFunction({value:t,row:i}):i[r.reference]=t:(n.noUpdate=!0,c=document.getElementById("cell: ".concat(a,"-").concat(i.index_,"-").concat(r.index_))),c&&(n.isOpening=!0,c.focus(),n.isOpening=!1),s?s(e):null})},n.onCellQuit_=function(e,t){var a=function(a){e.status=n.state.updatedRows[e.row.index_];var o=n.props.onCellQuit||e.column.onQuitFunction,r=o&&a?o(e):a;return void 0!==(r=r&&n.props.errorHandler(e,"onCellQuit"))&&t?t(r):r};return!e.row||!e.updated||function(t){var o=e.column,r=e.row,i=n.props.componentId,s=r[o.id];return o.foreignObjectFunction?p.l.isNullValue(s)?(o.onChangeFunction&&o.onChangeFunction({value:{id:null,cd:null},row:r}),a(t)):void n.foreignObject(n.isPasting?"match":"quit",{id:i,value:s,column:o,row:r,cellQuit:a}):a(t)}(!0)},n.onCellEnter=function(e,t,a){var o={value:e,row:t,status:n.state.updatedRows[t.index_],column:a,meta:n.state.meta,data:n.state.data,params:n.props.params};n.props.onCellEnter&&n.props.onCellEnter(o)},n.onRowQuit=function(e){return n.onRowQuit_(e,e.callback)},n.checkUnicity=function(e,t,n){var a=n.meta[e][n.row[t.id]],o=a!==n.row.index_&&void 0!==a;Object(w.i)(n.updatedRows,n.row.index_,t,"duplicate key",o?"".concat(t.caption,": duplicate key."):null),o||(delete n.meta[e][n.previousRow[t.id]],n.meta[e][n.row[t.id]]=n.row.index_)},n.onRowQuit_=function(e,t){var a=e.meta,o=e.updatedRows,r=e.row;if(e.rowUpdated){e.status=o[r.index_],a.properties.filter(function(e){return e.mandatory}).forEach(function(t){Object(w.i)(o,r.index_,t,"mandatory",p.l.isNullValue(t.accessorFunction?t.accessorFunction({row:e.row}):r[t.id])&&!e.status.deleted_?(t.caption||t.id)+": mandatory data.":null)});a.table.pk,a.table.lk;var i=n.props.onRowQuit||a.row.onQuitFunction,s=!i||i(e);return void 0!==(s=s&&n.props.errorHandler(e,"onRowQuit",t))&&t?t(s):s}return!0},n.onRowEnter=function(e){var t=n.state,a=t.meta,o=t.data,r=t.updatedRows,i=Object(w.e)(r,e),s=n.props.params,c={row:e,status:i,meta:a,data:o,params:s};e.editable_=a.row.editableFunction?a.row.editableFunction({row:e,status:i,data:o,params:s}):void 0===a.row.editable||a.row.editable,n.props.onRowEnter&&n.props.onRowEnter(c)},n.onRowNew=function(e){var t={row:e,status:Object(w.e)(n.state.updatedRows,e),meta:n.state.meta,data:n.state.data,filteredData:n.state.filteredData,params:n.props.params};return!n.props.onRowNew||!1!==n.props.onRowNew(t)},n.onTableEnter=function(){var e={updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params};n.tableUpdated=!1,n.rowUpdated=!1,n.updated=!1,n.props.onTableEnter&&n.props.onTableEnter(e)},n.beforeTableClose=function(){var e={updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params};n.props.beforeTableClose&&n.props.beforeTableClose(e)},n.onTableClose=function(){var e={updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params};if(Object(w.f)(n.state.updatedRows).length)return n.setState({confirmationModal:!0}),!1;n.props.onTableClose&&n.props.onTableClose(e)},n.buildMessage=function(e){return{updated:n.updated,rowUpdated:n.rowUpdated,tableUpdated:n.tableUpdated,previousValue:n.previousValue,row:n.row,previousRow:n.previousRow,column:n.column,meta:n.state.meta,data:n.state.data,params:n.props.params,updatedRows:n.state.updatedRows,callback:e}},n.canQuit=function(e,t){var a=n.buildMessage(t||function(){});return function(t){var o,r=function(t){return t&&(n.updated=!1),("cellQuit"===e?a.callback:function(e){var t=function(e){e&&(n.rowUpdated=!1),a.callback(e)},o=e&&(!n.rowUpdated||n.onRowQuit_(a,t));if(void 0!==o)return t(o)})(t)};if(void 0!==(o=t&&(!n.updated||n.onCellQuit_(a,r))))return r(o)}(!0)},n.handleErrors=function(e,t,a){if("zebulon-table-status"===e.target.className&&(!e.relatedTarget||e.relatedTarget.id!==e.target.id))if(a.length){var o={type:"error",top:e.target.parentElement.offsetTop+t*n.rowHeight+n.state.scroll.rows.shift,left:n.rowHeight,rowIndex:t,content:a};n.setState({toolTip:o}),console.log("tooltip",t,e.type,e.target,n.state.toolTip,o)}else n.state.toolTip&&(console.log("tooltip2",t,e.type,e.target,n.state.toolTip),n.setState({toolTip:null}))},n.handleText=function(e,t,a){var o;n.state.meta.row.descriptorFunction&&(o=n.state.meta.row.descriptorFunction({row:t}));var r={top:(3+e.rows-n.state.scroll.rows.startIndex)*n.rowHeight+n.state.scroll.rows.shift,left:a.position+n.rowHeight-n.state.scroll.columns.position,v:(a.accessorFunction||function(e){return e.row[a.id]})({row:t}),label:o,editable:a.editable,row:t,column:a};n.setState({text:r})},n.handleTextChange=function(e){var t=n.state.text,a=t.row,o=t.column;n.setState({text:Object(f.a)({},n.state.text,{v:e.target.value})}),n.onChange(e.target.value,a,o)},n.onMetaChange=function(e){n.setState({scroll:{rows:n.state.scroll.rows,columns:e?{index:0,direction:1,startIndex:0,shift:0,position:0}:n.state.scroll.columns}})},n}return Object(u.a)(t,e),t}(function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).handleClickMenu=function(e,t){if("column-header-menu"===e.menu){var a=e.column,o=n.state,r=o.data,i=o.meta,s=o.params,c=o.scroll;t.id<=1?(p.l.isNullOrUndefined(i.lockedIndex)||(i.properties[i.lockedIndex].locked=!1),t.id&&(i.properties[a.index_].locked=!0),Object(b.c)(i),n.setState({scroll:Object(f.a)({},c,{columns:{direction:1,index:0,position:0,shift:0,startIndex:0}})})):t.function({data:r,meta:i,params:s,column:a,table:Object(m.a)(Object(m.a)(n))})}else if("row-header-menu"===e.menu){var d=e.row,l=e.status,u=e.index,h=n.state,g=h.data,v=h.meta,w=h.params;h.updatedRows;if(0===t.id)n.setState({scroll:n.state.scroll});else{if(1!==t.id)return t.function({data:g,meta:v,params:w,row:d,status:l,table:Object(m.a)(Object(m.a)(n))});var y=n.state.scroll,C={rows:u,columns:(n.state.meta.visibleIndexes||[0])[0]},S={end:C,start:C};n.setState({scroll:{rows:{index:0,direction:1,startIndex:0,shift:0,position:0},columns:{index:0,direction:1,startIndex:0,shift:0,position:0}},prevScroll:y,selectedRange:{start:{rows:0,columns:0},end:{rows:0,columns:0}},prevRange:S})}}else if("top-left-corner-menu"===e.menu){var k=n.state,T=k.filters,x=k.data,O=k.meta,_=k.params,I=k.updatedRows,E=T.status_;E||(E={id:"status_",v:0});var F=t.id%100;if(E.v&F?E.v-=F:E.v+=F,2===t.id){var A=n.state.prevScroll,j=n.state.prevRange;n.setState({scroll:A,prevScroll:void 0,selectedRange:j,prevRange:void 0})}else 0===t.id||t.id>=100&&t.id<104?(0===t.id||0===E.v?delete T.status_:t.id>=100&&(T.status_=E),n.setState({filteredData:n.filters(x,T,!1,I)})):t.function({data:x,meta:O,params:_,table:Object(m.a)(Object(m.a)(n))})}else if("cell-menu"===e.menu){var R=e.row,D=e.column,M=n.state,P=M.data,z=M.meta,N=M.params;t.function({data:P,meta:z,params:N,row:R,column:D,table:Object(m.a)(Object(m.a)(n))})}},n}return Object(u.a)(t,e),t}(a.Component)),R=n(13),D=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(o)))).adjustScrollRows=function(e){if(n.state){var t=n.state,a=t.selectedRange,o=t.scroll,r=t.meta,i=n.props,s=i.componentId,c=i.id;if(e.length)if(void 0===a.end.rows){var d=(r.visibleIndexes||[0])[0];a.end={rows:0,columns:d},a.start={rows:0,columns:d},n.bLoaded=!0,n.scrollTo(a.end.rows,1,a.end.columns,o.columns.direction,!1,e.length),n.setState({scroll:Object(f.a)({},o)})}else a.end.rows>e.length-1?(a.end.rows=e.length-1,n.scrollTo(0,-1,a.end.columns,o.columns.direction,!1,e.length)):o.rows.index+n.rowsHeight/n.rowHeight>e.length-1?n.scrollTo(a.end.rows,o.rows.direction,a.end.columns,o.columns.direction,!1,e.length):n.setState({scroll:Object(f.a)({},o)});else{a.end={},a.start={},n.hasFocus=!1,n.bLoaded=void 0;var l=r.properties[(r.visibleIndexes||[0])[0]],u=document.getElementById("filter: ".concat(s||c,"--").concat(l.index_,"-"));u&&u.children[0]&&u.children[0].focus()}return n.selectRange(a,void 0,e[a.end.rows],"enter"),n.row=e[a.end.rows],n.row}},n.filters=function(e,t,a,o){if(!Array.isArray(e))return[];var r=Object(R.a)(t,n.props.params,e,o),i=e.filter(r);return n.props.onFilter&&n.props.onFilter({filters:t,filteredData:i,data:e,params:n.props.params,updatedRows:o}),i},n.getFilterItems=function(e,t){var a=n.state,o=a.meta,r=a.updatedRows,i=n.props.data;if(!e||!e.items){o.table.filteredByServer&&t.selectItems&&(i=p.l.isMap(t.selectItems)?Array.from(t.selectItems).map(function(e){return e[1]}):p.l.isObject(t.selectItems)?Object.values(t.selectItems):t.selectItems,t.reference&&(i=i.map(function(e){return Object(F.a)({},t.reference,e)})));var s={};i.forEach(function(e){var a=p.l.isObject(e)?e:Object(F.a)({},t.id,e),o=(t.foreignKeyAccessorFunction||t.accessorFunction||function(e){return e.row[t.id]})({row:a,column:t,status:r[a.index_],params:n.props.params,data:i}),c=(t.accessorFunction||function(e){return e.row[t.id]})({row:a,column:t,status:r[a.index_],params:n.props.params,data:i}),d=o,l="";"object"===typeof(o||void 0)?(c=o.caption,d=o.caption,o=o.value):c=(t.formatFunction||function(e){var n=e.value;return p.l.formatValue(n,null,t.decimals)})({value:c,column:t,row:a,params:n.props.params,status:r[a.index_],data:i}),"date"===t.dataType?l=new Date(null):"number"===t.dataType&&(l=-1/0),s[o]={id:o,label:c,sort:d||l}}),t.items=Object.values(s),t.items.sort(function(e,t){return(e.sort>t.sort)-(e.sort<t.sort)}),e=t}return e},n.openFilter=function(e,t){if(!n.isOpening){var a=n.state.filters[t.id];a=n.getFilterItems(a,t);var o=e.target.getBoundingClientRect(),r=document.getElementById("table-".concat(n.props.id)).getBoundingClientRect();return a.top=o.y-r.y,a.left=o.x-r.x,n.canQuit("rowQuit",function(o){if(o)return n.openFilter_(e,t,a)})?n.openFilter_(e,t,a):void 0}},n.openFilter_=function(e,t,a){if("values"!==t.filterType)return n.hasFocus=!1,n.closeOpenedWindows();e.preventDefault(),e.stopPropagation(),e.persist(),n.hasFocus=!1,n.setState({openedFilter:t.id,filters:Object(f.a)({},n.state.filters,Object(F.a)({},t.id,a))})},n.onChangeFilter=function(e){var t=e.value,a=e.row,o=e.column,r=e.filterTo;n.state.status.loaded&&(n.props.onTableChange("filter",function(e){e&&n.onChangeFilter_(t,a,o,r)})&&n.onChangeFilter_(t,a,o,r))},n.onChangeFilter_=function(e,t,a,o){var r=n.state,i=r.selectedRange,s=r.filters,c=r.meta,d=r.data,l=r.updatedRows;n.closeOpenedWindows();var u=e;if((!u||void 0!==u.value||void 0===u.editedValue)&&(u!==a.v&&!o||u!==a.vTo&&o)){n.hasFocus=!1,"between"===a.filterType&&o?a.vTo=u:a.v=u,s[a.id]=a;var p=n.filters(d,s,!0,l);n.sorts(p,c.properties),n.setState({filteredData:p}),n.selectRange(i,void 0,n.adjustScrollRows(p),"enter",!0)}},n.onChangeFilterValues=function(e){var t=n.state.openedFilter;n.setState({openedFilter:void 0}),n.props.onTableChange("filter",function(a){a&&n.onChangeFilterValues_(t,e)})&&n.onChangeFilterValues_(t,e)},n.onChangeFilterValues_=function(e,t){var a=n.state,o=a.filters,r=a.meta,i=a.data,s=o[e];s.v=t,o[s.id]=s;var c=n.filters(i,o);n.sorts(c,r.properties),n.setState({filteredData:c}),n.selectRange(n.range,void 0,n.adjustScrollRows(c),"enter",!0)},n.sorts=function(e,t){var a=Object(R.c)(t);if(!Array.isArray(e))return n.state&&n.state.meta.serverPagination?n.pagination({sorts:a,callbackAfter:function(){n.selectRange_(n.range,void 0,void 0,"enter",n.hasFocus)}}):[];a.length&&e.sort(Object(R.d)(a)),n.props.onSort&&n.props.onSort({sorts:t,filteredData:e,data:n.props.data,params:n.props.params})},n.onSort=function(e,t){n.state.meta.table.noOrder||n.props.onTableChange("sort",function(a){a&&n.onSort_(e,t)})&&n.onSort_(e,t)},n.onSort_=function(e,t){var a=n.state,o=a.filteredData,r=a.meta;if(n.closeOpenedWindows(),!1===n.selectRange(n.range,void 0,n.row,"quit",n.hasFocus))return!1;var i=r.properties,s=[];i.forEach(function(n){t&&n.id!==e.id&&(n.sort=void 0,n.sortOrder=void 0),n.id===e.id&&(void 0===n.sort?n.sort="asc":"asc"===n.sort?n.sort="desc":"desc"===n.sort&&(n.sort=void 0,n.sortOrder=void 0)),void 0!==n.sort&&s.push({index:n.index_,sortOrder:void 0===n.sortOrder?1e3:n.sortOrder})}),s.sort(function(e,t){return(e.sortOrder>t.sortOrder)-(t.sortOrder>e.sortOrder)}),s.forEach(function(e,t){return i[e.index].sortOrder=t}),n.sorts(o,i),r.serverPagination||(n.selectRange(n.range,void 0,void 0,"enter",n.hasFocus),n.setState({filteredData:o}))},n}return Object(u.a)(t,e),t}(j),M=function(e){function t(){var e,n;Object(s.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(d.a)(this,(e=Object(l.a)(t)).call.apply(e,[this].concat(r)))).cell=function(e,t,a,r,i,s,c,d,l,u,f,h,m,b,g,w,y,S){var k=Object(v.a)(t,a,r,i,s,d),T=k.editable,x=k.value,O=k.select,_=k.dataType,I=C()({"zebulon-table-cell":!0,"zebulon-table-cell-odd":w%2===1,"zebulon-table-cell-selected":u,"zebulon-table-cell-focused":d,"zebulon-table-cell-editable":T&&d,"zebulon-table-cell-select":T&&d&&O,"zebulon-table-cell-checkbox":"boolean"===_}),E="cell: ".concat(S,"-").concat(t.index_,"-").concat(a.index_);return d&&l&&T&&(n.focused=E),o.a.createElement(p.f,{row:t,column:a,style:c,className:I,value:x,editable:T&&e,focused:d,hasFocus:l,select:O,dataType:_,inputType:"cell",id:E,key:E,onChange:b,onMouseDown:f,onMouseUp:h,onMouseOver:m,onFocus:g,onDoubleClick:y?function(e){return y(e,t,a)}:function(){},menu:"cell-menu",component:S})},n.rowRenderer=function(e,t,a,r,i,s,c,d,l,u,f){for(var h=[],m=s,b=i,g=n.selectedRange();b<r.length&&m<c;){var v=r[b];v.hidden||function(){var o=v.alignement||"left";v.alignement||("number"===v.dataType?o="right":"date"!==v.dataType&&"month"!==v.dataType&&"year"!==v.dataType&&"boolean"!==v.dataType||(o="center"));var r=b,i=p.l.isInRange({columns:b,rows:l},g.start,g.end),s=g.end.rows===l&&g.end.columns===b;h.push(n.cell(e,t,v,a,n.props.data,n.props.params,{position:"absolute",left:m,width:Math.min(v.computedWidth,c-m),height:d,textAlign:o},s,u&&s,i,function(e){n.selectCell({rows:l,columns:r},e.shiftKey,!1)},function(e){n.mouseDown=!1},function(e){1!==(1&e.buttons)||n.noOver||n.props.openedFilter||n.selectCell({rows:l,columns:r},!1)},n.props.onChange,n.props.onFocus,l,n.props.onDoubleClick,f)),m+=v.computedWidth}(),b+=1}return o.a.createElement("div",{key:l,id:l,style:{display:"flex",height:d}},h)},n.getContent=function(){var e=[],t=n.props,a=t.data,r=t.meta,i=t.height,s=t.rowHeight,c=t.width,d=t.updatedRows,l=t.hasFocus,u=t.componentId,f=t.locked,h=0,m=n.props.scroll.rows.startIndex,b=0,g=a,v=n.props.scroll.columns.startIndex,w=n.props.scroll.columns.shift;"object"===typeof a&&a.page&&(g=a.page,b=a.pageStartIndex);var y=c-n.scrollbars.vertical.width;for(n.props.noVerticalScrollbar?(v=0,w=0):v=Math.max(v,p.l.isNullOrUndefined(r.lockedIndex)?0:r.lockedIndex+1);m<g.length&&h<i/s;){var C=g[m-b],S=d[C.index_];r.serverPagination&&S&&S.rowUpdated&&(C=S.rowUpdated),e.push(n.rowRenderer(r.table.editable,C,S,r.properties,v,w,y,s,m,l,u)),m++,h++}var k={top:n.props.scroll.rows.shift||0,width:y,position:"inherit",height:"inherit"};return console.log("render row"),o.a.createElement("div",{id:"content",style:k,onWheel:n.onWheel,className:f?"zebulon-locked-columns":""},e)},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"shouldComponentUpdate",value:function(e){return!e.status.loadingPage&&!e.noUpdate}},{key:"componentDidUpdate",value:function(){this.noOver=!1}}]),t}(p.g),P=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).handleClickNext=function(e){var t=n.state,a=t.cell,o=t.value,r=t.rowIndexes,i=t.indexRowIndex,s=t.properties,c=Object(v.f)(o),d=Object(f.a)({},a),l=i;if(d.columns=Object(v.b)(n.props.filteredData[d.rows],s,c,d.columns+e,e),null===d.columns&&(1===e&&l<r.length-1||-1===e&&0!==l)&&(l+=e,d.rows=r[l],d.columns=Object(v.b)(n.props.filteredData[d.rows],s,c,-1===e?s.length-1:0,e)),null!==d.columns){var u=Object(f.a)({},d,{columns:s[d.columns].index_});n.props.scrollTo(u.rows,Math.sign(u.rows-(n.state.cell.rows||0)),u.columns,Math.sign(u.columns-(n.props.selectedCell.columns||0))),n.setState({cell:d,indexRowIndex:l})}},n.handleChange=function(e){var t=e.target.value,a=Object(v.f)(t),o={rows:void 0,columns:void 0},r=-1;if(p.l.isNullValue(t&&t!==n.state.value))n.setState({value:t,rowIndexes:[],cell:o,indexRowIndex:-1});else{var i=n.props,s=i.rowStartIndex,c=i.rowStopIndex,d=i.filteredData,l=n.state.dataStrings,u=Object(v.g)(l,a);if(n.setState({value:t,rowIndexes:u}),u.length){-1===(r=u.findIndex(function(e){return e>=s&&e<=c}))&&(r=u[u.length-1]>c?u.findIndex(function(e){return e>c}):u.length-1),o.rows=u[r];var h=d[o.rows];o.columns=Object(v.b)(h,n.state.properties,a);var m=Object(f.a)({},o,{columns:n.state.properties[o.columns].index_});n.props.scrollTo(m.rows,Math.sign(m.rows-(n.props.selectedCell.rows||0)),m.columns,Math.sign(m.columns-(n.props.selectedCell.columns||0)),!0)}n.setState({value:t,rowIndexes:u,cell:o,indexRowIndex:r})}n.input.focus()};var a=e.filteredData,o=e.meta,r=e.dataStrings,i=e.rowStartIndex,c=e.rowStopIndex,u=o.properties.filter(function(e){return!e.hidden});return n.state={dataStrings:Object(v.e)(a,u,r),value:"",properties:u,cell:{},rowStartIndex:i,rowStopIndex:c},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("input",{style:{width:200},onChange:function(t){return e.handleChange(t)},value:this.state.value,autoFocus:!0,ref:function(t){return e.input=t}}),o.a.createElement("div",{style:{background:p.k.downArrow,backgroundSize:"cover",height:"1em",width:"1em",marginTop:"0.1em",marginRight:"0.1em"},onClick:function(){return e.handleClickNext(1)}}),o.a.createElement("div",{style:{background:p.k.upArrow,backgroundSize:"cover",height:"1em",width:"1em",marginTop:"0.4em",marginRight:"0.1em",zoom:.7},onClick:function(){return e.handleClickNext(-1)}}),o.a.createElement("div",{style:{background:p.k.close,backgroundSize:"cover",height:"1em",width:"1em",marginTop:"0.7em",zoom:.5,marginRight:"0.1em",marginLeft:".6em"},onClick:this.props.onClose}))}}]),t}(a.Component),z=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).onLoad=function(){n.bLoaded&&(n.updated=!1,n.rowUpdated=!1,n.tableUpdated=!1,n.adjustScrollRows(n.state.filteredData),n.bLoaded=null)},n.onCheckAll=function(){var e=!n.state.checkAll;n.state.filteredData.forEach(function(t){return t.checked_=e}),n.setState({checkAll:e,updatedRows:n.state.updatedRows})},n.getActions=function(e,t,a,r,i){var s=n.state,c=s.meta,d=s.status,l=s.selectedRange,u=s.updatedRows,p=c.table.actions,f=c.table.actionIcons&&e;return p=(p=p.map(function(s,h){!n.doubleClickAction&&s.doubleClick&&(n.doubleClickAction=s);var m=s.enable||!1;if(d.loadingPage)m=!1;else if(s.enableFunction){var b=void 0!==l.end.rows?n.getRow(l.end.rows):{index_:void 0},g=u[b.index_];m=s.enableFunction({row:b,status:g})}s.statusEnable=s.enable&&m;var v=c.properties[c.properties.length-1],w=m?".zebulon-action-button":".zebulon-action-button-disabled";if(f){var y=s.icon||S.a;return o.a.createElement(y,{style:{marginRight:10},className:w,onClick:function(e){return n.handleAction(s,e)},key:h,id:h,onMouseOver:function(e){n.handleToolTip(s,e,!1)},onMouseOut:function(e){n.handleToolTip(s,e,!0)}})}if("null"!==e){var C={width:Math.min(v.position+v.computedWidth+n.rowHeight*(null!==t),a-4*p.length)/p.length||0,minWidth:50,margin:2,marginTop:3,height:22};return s.jsxFunction?s.jsxFunction({disabled:!m,className:w,index:h,style:C,onClick:function(e){return n.handleAction(s,e)}}):(r="action-".concat(i,"-").concat(h),o.a.createElement("button",{id:r,key:r,disabled:!m,className:w,style:C,draggable:!1,onClick:function(e){return n.handleAction(s,e)}},s.caption))}})).length&&f?o.a.createElement("div",{style:{display:"flex"}},p):p.length?o.a.createElement("div",{id:"actions",style:{height:f?0:30,display:"flex"}},p):null};var a=n.filters(e.data,e.filters);n.sorts(a,e.meta.properties);var r=e.meta&&e.meta.visibleIndexes?e.meta.visibleIndexes[0]:0;return n.state={data:e.data,filteredData:a,params:e.params,meta:e.meta,filters:e.filters||{},status:e.status,updatedRows:e.updatedRows,scroll:{rows:{index:0,direction:1,startIndex:0,shift:0,position:0},columns:{index:0,direction:1,startIndex:0,shift:0,position:0}},selectedRange:{start:{rows:void 0,columns:r},end:{rows:void 0,columns:r}},detail:{},text:{},checkAll:!1,search:!1,dataStrings:{}},n.rowHeight=n.props.rowHeight,n.range={start:{},end:{}},n.onTableEnter(),e.status&&e.status.loaded&&(n.bLoaded=!0),n.hasFocus=!0,n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.data!==this.props.data||e.meta!==this.props.meta||e.status!==this.props.status||e.updatedRows!==this.props.updatedRows||e.filters!==this.props.filters){var t,n=e.status;if(t=this.filters(e.data,e.filters,void 0,e.updatedRows),e.status.loaded&&e.isModal&&this.props.onDoubleClick&&this.props.onRowEnter){var a=t,o=Object.values(e.filters)[0];1===a.length&&["quit","match"].includes(e.selection)?(this.props.onRowEnter({row:a[0]}),this.props.onDoubleClick()):a.length>=1&&"match"===e.selection&&1===(a=a.filter(function(e){return e[o.id]===o.v})).length&&(this.props.onRowEnter({row:a[0]}),this.props.onDoubleClick())}if(this.sorts(t,e.meta.properties),this.setState({data:e.data||[],filteredData:t,filteredDataLength:t.length,filters:e.filters||{},meta:e.meta,status:n,updatedRows:e.updatedRows}),(n&&n.loaded&&void 0===this.bLoaded||e.filters!==this.state.filters)&&(this.bLoaded=!0),n&&n.loading&&(this.bLoaded=void 0),n.loaded&&this.props.callbackForeignKey&&t.length<2)return this.props.callbackForeignKey(1===t.length,t[0]),null}this.rowHeight=e.rowHeight,e.visible&&!this.props.visible&&this.onTableEnter(),!e.isActive&&this.props.isActive&&this.closeOpenedWindows()}},{key:"shouldComponentUpdate",value:function(e,t){return!this.isPasting}},{key:"componentWillUnmount",value:function(){return this.onTableClose()}},{key:"componentDidMount",value:function(){this.onLoad(),this.props.setActions&&this.props.setActions(this.getActions("null"))}},{key:"componentDidUpdate",value:function(){this.onLoad(),console.log("tableUpdated"),this.changingFilter=!1}},{key:"render",value:function(){var e,t,n,a=this,r=this.props,i=r.height,s=r.width,c=r.isModal,d=r.visible,l=r.params,u=r.id,h=this.state,m=h.status,b=h.meta,g=h.selectedRange,v=h.updatedRows,w=h.data,y=h.auditedRow,C=(h.audits,h.scroll),S=h.statusChanged,k=""===this.props.caption?null:this.props.caption||b.table.caption,T=this.selectRange,x=this.onScroll,O=1+!b.table.noFilter*(1+(-1!==b.properties.findIndex(function(e){return"between"===e.filterType&&!e.hidden})));e=this.state.filteredData,t=this.state.filteredData.length;var I=y||c||0===b.properties.length?[]:b.table.actions.filter(function(e){return!e.hidden})||[],F=b.table.actionIcons&&k;if(!d)return null;if(m.loading||m.loadingConfig)return o.a.createElement("div",null,"Loading data...");if(m.error)return"No rows retrieved"===m.error.message?o.a.createElement("div",{style:{width:"max-content"}},"No rows retrieved"):o.a.createElement("div",{style:{color:"red",width:"max-content"}},o.a.createElement("p",null,m.error.type),o.a.createElement("p",null,m.error.message));if(0===w.length&&0===b.properties.length)return null;var A=!this.isInPage(C.rows)||this.noUpdate;this.noUpdate=!1;var j=this.state,R=j.openedFilter,D=j.filters;if(this.openedFilter=null,void 0!==R&&D[R]){var z=D[R],N=z.top,L=z.left,B=z.items,U=z.v,H=z.caption;z.computedWidth;n="filter-".concat(u),this.filter=o.a.createElement(p.e,{id:n,key:n,items:B,title:H,filter:U,style:{position:"absolute",border:"solid 0.1em rgba(0, 0, 0, 0.5)",backgroundColor:"white",fontFamily:"inherit",top:N,left:L,zIndex:3,opacity:1},onOk:this.onChangeFilterValues,ref:function(e){return a.openedFilter=e}})}else this.filter=null;var W=this.state.text,K=W.top,G=W.left,V=W.v,Q=W.editable,q=W.label;void 0!==K?(n="textarea-".concat(u),this.text=o.a.createElement("div",{id:n,key:n,style:{border:"solid 0.1em rgba(0, 0, 0, 0.5)",backgroundColor:"white",top:K+(O-2)*this.rowHeight,left:G,zIndex:3,opacity:1}},o.a.createElement("div",null,q," "),o.a.createElement("textarea",{rows:"10",cols:"80",id:"textarea",tabIndex:0,style:{top:K,left:G,font:"inherit"},disabled:!Q,autoFocus:!0,value:V||"",onChange:this.handleTextChange}))):this.text=void 0;var J=this.state.detail.content;if(J){var X=void 0!==g.end.rows?this.getRow(g.end.rows):{},Y=v[X.index_];J=this.getDetail({Detail:J,row:X,data:w,meta:b.properties,status:Y,params:l,top:(2+O+g.end.rows-C.rows.startIndex)*this.rowHeight+C.rows.shift,onChange:b.row.onChange,onClose:this.closeOpenedWindows})}var Z=this.state.toolTip||null;if(Z){var $=Z.content;"error"===Z.type&&($=o.a.createElement("ul",{style:{paddingLeft:20,maxWidth:300}},Z.content.map(function(e,t){return o.a.createElement("li",{key:t},e.error)}))),n="tooltip-".concat(u),Z=o.a.createElement("div",{id:n,key:n,className:"zebulon-tool-tip",style:{top:Z.top,left:Z.left}},$)}this.rowsHeight=i-(k?30:0)-O*this.rowHeight-(!I.length||b.table.actionIcons&&void 0!==k?0:30);var ee,te=null;if(this.state.search){var ne=this.state,ae=ne.filteredData,oe=ne.meta,re=ne.dataStrings,ie=ne.scroll;n="search-".concat(u);var se=o.a.createElement(P,{id:n,key:n,filteredData:ae,meta:oe,dataStrings:re,scroll:ie,rowStartIndex:ie.rows.startIndex+ie.rows.shift===0?0:1,rowStopIndex:Math.min(ie.rows.startIndex+Math.floor(this.rowsHeight/this.rowHeight)-(0===ie.rows.shift?1:0),ae.length-1),onClose:function(){return a.setState({search:!1})},selectedCell:this.state.selectedRange.end,scrollTo:this.scrollTo});te=o.a.createElement("div",{id:n,key:n,className:"zebulon-tool-tip",style:{top:0,left:0,position:"absolute"}},se)}b.table.noStatus?ee=null:(n="statusbar-".concat(u),ee=o.a.createElement(E,{id:n,key:n,data:e,status:m,dataLength:t,height:this.rowsHeight,rowHeight:this.rowHeight,scroll:C.rows,updatedRows:v,selectRange:this.selectRange,selectedIndex:g.end.rows,meta:b,handleErrors:this.handleErrors,noUpdate:A,componentId:this.props.componentId,checkable:b.table.checkable,onDoubleClick:this.onDoubleClick,draggable:b.table.statusDraggable,isAudit:!!y,statusChanged:S})),I=this.props.setActions?null:this.getActions(k,ee,s,n,u);var ce=!p.l.isNullOrUndefined(b.lockedIndex)&&!!b.lockedWidth;n="rows-".concat(u);var de=o.a.createElement(M,{id:n,key:n,meta:b,data:e,status:m,dataLength:t,height:this.rowsHeight,width:s-this.rowHeight*(null!==ee)-(b.lockedWidth||0),rowHeight:this.rowHeight,scroll:C,onScroll:x,selectedRange:g,selectRange:T,onChange:this.onChange,onFocus:function(e,t,n){return a.closeOpenedWindows(!0,n,t)},hasFocus:this.hasFocus&&!1!==this.props.isActive,updatedRows:v,params:l,navigationKeyHandler:this.props.navigationKeyHandler,ref:function(e){return a.rows=e},noUpdate:A,onDoubleClick:this.onDoubleClick,componentId:this.props.componentId,openedFilter:this.state.openedFilter,scrollbarsOnBox:this.props.scrollbarsOnBox}),le=null;ce&&(n="locked-columns-".concat(u),le=o.a.createElement(M,{id:n,key:n,meta:b,data:e,status:m,dataLength:t,height:this.rowsHeight,width:b.lockedWidth,rowHeight:this.rowHeight,scroll:C,onScroll:x,selectedRange:g,selectRange:T,onChange:this.onChange,onFocus:function(e,t,n){return a.closeOpenedWindows(!0,n)},hasFocus:this.hasFocus&&!1!==this.props.isActive,updatedRows:v,params:l,noUpdate:A,noVerticalScrollbar:!0,onDoubleClick:this.onDoubleClick,locked:ce,componentId:this.props.componentId,openedFilter:this.state.openedFilter,scrollbarsOnBox:this.props.scrollbarsOnBox})),n="headers-".concat(u);var ue=o.a.createElement(_,{id:n,key:n,onSort:this.onSort,meta:b,data:w,height:this.rowHeight*O,width:s-this.rowHeight*(null!==ee)-(b.lockedWidth||0),scroll:C.columns,headersLength:O,onMetaChange:this.onMetaChange,openFilter:this.openFilter,onChange:this.onChangeFilter,componentId:this.props.componentId,isActive:this.props.isActive,onActivation:this.props.onActivation,changingFilter:this.changingFilter}),pe=null;!p.l.isNullOrUndefined(b.lockedIndex)&&b.lockedWidth&&(n="locked-headers-".concat(u),pe=o.a.createElement(_,{id:n,key:n,onSort:this.onSort,meta:b,data:w,height:this.rowHeight*O,width:b.lockedWidth,scroll:C.columns,headersLength:O,onMetaChange:this.onMetaChange,openFilter:this.openFilter,onChange:this.onChangeFilter,locked:!0,componentId:this.props.componentId,isActive:this.props.isActive,onActivation:this.props.onActivation,changingFilter:this.changingFilter}));var fe=[];if(null!==ee){for(var he=0;he<O;he++){var me=null;0===he&&!0===b.table.checkable&&(me=o.a.createElement("input",{type:"checkbox",checked:this.state.checkAll,onChange:this.onCheckAll})),n="status-bar-headers-".concat(u,"-").concat(he),fe.push(o.a.createElement("div",{id:n,key:n,className:"zebulon-table-corner",style:{width:this.rowHeight,height:this.rowHeight,top:he*this.rowHeight}},me))}n="header-status-".concat(u),fe=o.a.createElement(p.c,{id:n,key:n,menu:"top-left-corner-menu",componentId:this.props.componentId},fe)}else fe=null;var be=null;return k&&(n="title-".concat(u),be=o.a.createElement(p.c,{id:n,key:n,className:"zebulon-table-title",style:{display:"flex",fontWeight:"bold",textAlign:"center",padding:4,border:"solid 0.03em rgba(0,0,0,.2)",height:30,width:s,boxSizing:"border-box",justifyContent:"space-between"},menu:"title-menu",componentId:this.props.componentId,onClick:function(){a.props.onActivation&&a.props.onActivation(a.props.componentId||u)}},o.a.createElement("div",{style:{textAlign:"center",width:"inherit"}},k),F?I:null)),o.a.createElement("div",{id:u,style:Object(f.a)({width:s,height:i},this.props.style)},o.a.createElement("div",{id:"table-".concat(u),style:{width:s,height:i,display:"block",position:"absolute"}},J,this.filter,this.text,te,be,o.a.createElement("div",{id:"columns",style:{display:"flex"}},fe,pe,ue),o.a.createElement("div",{id:"rows",style:{display:"flex"}},ee,le,de),F?null:I),Z)}}]),t}(D),N=n(20),L=n(15),B=n(10),U=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).setFilters=function(e,t){return t.forEach(function(t){e[t.id]?(t.filterType=e[t.id].filterType,t.v=e[t.id].v,t.vTo=e[t.id].vTo,t.link=e[t.id].link,e[t.id]=t):p.l.isNullOrUndefined(t.v)&&("between"!==t.filterType||p.l.isNullOrUndefined(t.vTo))||(e[t.id]=t)}),e},n.setSorts=function(e,t){t.forEach(function(t){e[t.id]?(t.sortOrder=e[t.id].sortOrder,t.sort=e[t.id].direction):(t.sortOrder=void 0,t.sort=void 0)})},n.refresh=function(){return n.setState(n.getData(n.props))},n.getData=function(e){n._isMounted&&n.setState({status:{loaded:!1,loading:!0}}),n.observable=null;var t=e.data,a=e.meta,o=e.params,r=(e.filteredData,n.state),i=r.sorts,s=r.filters;e.filters&&Object.values(e.filters).filter(function(e){return e.link}).forEach(function(e){return s[e.id]=e});var c={dataObject:a.table.object,params:o,meta:a,filters:Object(B.getFilters)(a.properties,s||{}),sorts:i?Object.values(i):Object(B.getSorts)(a.properties),props:e,state:n.state};return"function"===typeof t?t=t(c):!Array.isArray(t)&&(a&&e.select||a.table.select)&&(t=(t=e.select||n.state.functions.getAccessorFunction(a.table.object,"dmls",a.table.select))(c)),Array.isArray(t)?(a.table.noDataMutation&&(t=Object(h.a)(t)),n.initData(t,a,n.state.sizes.zoom,n.state.functions,0,s),n.subscribe(c,n.state.meta.table.subscription)):p.l.isPromise(t)?n.resolvePromise(t,c):p.l.isObservable(t)?(n.subscribeObservable(t,c),t=[]):t=[],{data:t,meta:a,filters:s,sorts:i,updatedRows:{}}},n.initData=function(e,t,a,o,r,i){Array.isArray(e)&&(t.config=n.config?n.config.properties:void 0,Object(B.computeMetaFromData)(e,t,a,o,n.props.privileges?n.props.privileges.get(n.props.componentName):null),n.config=void 0,Promise.all(t.promises).then(function(s){n.initData2(e,t,a,o,r,i)}))},n.initData2=function(e,t,a,o,r){var i=n.state.filters;if(Array.isArray(e)){var s=t.table.noDataMutation?Object(h.a)(e):e;if(Object(B.computeData)(s,t,r,t.table.noDataMutation),n.props.filteredData&&t.indexPk){var c=n.state.updatedRows;Object.values(n.props.filteredData).forEach(function(e){return c[t.indexPk[e.id]]=e})}n.props.onGetData&&n.props.onGetData({data:s,meta:t,updatedRows:n.state.updatedRows}),n.initSizes(t,s,n.state.sizes),i&&0!==t.properties.length&&n.setFilters(i,t.properties),n.state.sorts&&0!==t.properties.length&&n.setSorts(n.state.sorts,t.properties),n._isMounted?n.setState({data:s,status:{loaded:!0,loading:!1},filters:i}):(n.state.data=s,n.state.filters=i,n.state.status={loaded:!0,loading:!1})}},n.resolvePromise=function(e,t){e.then(function(e){var a=n.state,o=a.meta,r=a.functions,i=a.sizes;return n.initData(e,o,i.zoom,r,0,t.filters),n.subscribe(t,o.table.subscription),e}).catch(function(e){return n.setState({data:[],status:{loaded:!1,loading:!1,error:e}})})},n.subscribeObservable=function(e,t){n.observable=e,n.observable.subscribe(function(e){n.initData(e,n.state.meta,n.state.sizes.zoom,n.state.functions,n.state.data.length,n.state.filters),n.observable&&n.setState({data:n.state.data.concat(e),meta:n.state.meta})},function(e){return n.setState({data:[],status:{loaded:!1,loading:!1,error:e}})},function(){n.setState({status:{loaded:!0,loading:!1}}),n.subscribe(t,n.state.meta.table.subscription)})},n.subscribe=function(e,t){if(t){var a=n.state,o=a.data,r=a.meta,i=a.updatedRows;e.index=r.indexRowId||r.indexPk,e.data=o,e.updatedRows=i,n.observable=t.observableFunction(e);var s=t.observerFunctions,c=s.onNext,d=s.onError,l=s.onCompleted;n.observable.subscribe(function(t){c(t,e),n.setState({status:{loaded:!0,loading:!1}})},function(t){d(t,e),n.setState({status:{loaded:!1,loading:!1,error:t}})},function(){return l(e)})}},n.initSizes=function(e,t,n){if(n.auto&&(n.height=null,n.width=null),!n.height||!n.width){var a=Object(B.getSizes)(e,n.rowHeight||e.row.height||25);if(!n.height&&t&&(n.height=e.table.height||Math.min(n.maxHeight||1e3,Math.max(n.minHeight||100,a.headersHeight+t.length*a.rowHeight))),!n.width){var o=a.headersHeight+t.length*a.rowHeight>(n.maxHeight||1e3)?p.i.ScrollbarSize:0;n.width=e.row.width||Math.min(n.maxWidth||2e3,Math.max(n.minWidth||100,a.headersWidth+a.rowWidth+o))}}},n.componentDidMount=function(){n._isMounted=!0,n.props.getComponent&&n.props.getComponent(Object(m.a)(Object(m.a)(n)))},n.componentWillUnmount=function(){return n._isMounted=!1},n.handleKeyEvent=function(e){if(n.state.confirmationModal&&n.modal)return 27===(e.which||e.keyCode)&&(e.preventDefault(),n.modal.onEscape()),void(13===(e.which||e.keyCode)?(e.preventDefault(),n.modal.onEnter()):n.modal.component&&n.modal.component.handleKeyDown&&n.modal.component.handleKeyDown(e));var t=p.l.isZoom(e);if(t&&(void 0===n.props.isActive||n.props.isActive)){e.preventDefault();var a=n.state.sizes;return a.zoom*=1===t?1.1:1/1.1,Object(b.c)(n.state.meta,a.zoom),void n.setState({sizes:Object(f.a)({},a)})}n.table&&("copy"===e.type?n.handleCopy(e):"paste"===e.type?n.handlePaste(e):"keydown"===e.type&&n.handleKeyDown(e))},n.handleKeyDown=function(e){!e.defaultPrevented&&n.table&&n.table.handleKeyDown&&(void 0===n.props.isActive||n.props.isActive)&&n.table.handleKeyDown(e)},n.handleCopy=function(e){!e.defaultPrevented&&n.table&&n.table.handleCopy&&(void 0===n.props.isActive||n.props.isActive)&&n.table.handleCopy(e)},n.handlePaste=function(e){!e.defaultPrevented&&n.table&&n.table.handlePaste&&(void 0===n.props.isActive||n.props.isActive)&&n.table.handlePaste(e)},n.rollback=function(e,t){Object(w.j)(e,t),n.props.linkedObjects&&n.props.linkedObjects.forEach(function(e){return e.rollbackFiltered()})},n.rollbackFiltered=function(){Object(w.l)(n.state.updatedRows,n.props.filters),n.setState({status:n.state.status})},n.errorHandler=function(e,t,a,o){var r,i=(n.props.errorHandler||w.b)[t];if("onTableQuit"===t&&!(e.updatedRows||{}).nErrors||"onSave"===t&&!(e.updatedRows||{}).nErrorsServer&&!e.conflicts?i=null:"onRowQuit"!==t||((e.status||{}).errors||{}).n_||(i=null),i){var s=i(e),c=e.modalBody;e.modalBody=null;var d=e.conflicts;if(e.conflicts=null,!1===s)return c&&n.setState({confirmationModal:!0,modal:{body:c,type:"Ok"}}),!1;if(c){var l="onTableChange"===t?"YesNoCancel":"YesNo";return void n.setState({confirmationModal:!0,modal:{body:c,type:l,callback:a}})}if(d){var u=e.messages.findIndex(function(e){return e.meta.table.object===d.object}),p=e.meta.table.object===d.object?Object(m.a)(Object(m.a)(n)):n.props.linkedObjects.find(function(e){return e.state.meta.table.object===d.object});return void p.setState({confirmationModal:!0,modal:{body:p.onConflict(d.data),type:"conflict",callback:(r=e.messages[u].updatedRows,function(e,i){e&&(i.forEach(function(e){var t=d.data[e].server;t.index_=e,r[e].row=t,n.rollback(r,e)}),("onSave"===t&&o?o:a)(e))})}})}}return!0},n.onClose=function(e){return n.onTableChange("close",e)},n.onTableChange=function(e,t){var a=n.onTableChange_;n.table.canQuit("rowQuit",function(a){a&&n.onTableChange_(e,t)})&&a(e,t)},n.rollbackAll=function(){Object(w.k)(n.state.updatedRows,n.state.data),n.setState({updatedRows:{}}),n.table&&(n.table.updated=!1,n.table.rowUpdated=!1,n.table.tableUpdated=!1,n.table.adjustScrollRows(n.table.state.filteredData)),n.props.linkedObjects&&n.props.linkedObjects.forEach(function(e){e.rollbackAll&&e.rollbackAll()})},n.onTableChange_=function(e,t){var a=t||"refresh"!==e?t:function(e){e&&(n.getData(n.props),n.table.updated=!1,n.table.rowUpdated=!1,n.table.tableUpdated=!1,n.props.linkedObjects&&n.props.linkedObjects.forEach(function(e){e.refresh&&e.refresh()}))};if(!Object(w.f)(n.state.updatedRows).length)return a(!0);var o={updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params,type:e},r=n.errorHandler(o,"onTableChange",function(e,t){e&&t?n.onSave(a):e?(n.rollbackAll(),a(!0)):a(!1)});void 0!==r&&a(r)},n.onSave=function(e){var t={messages:[{updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params,table:n.table}],updatedRows:n.state.updatedRows,meta:n.state.meta,data:n.state.data,params:n.props.params,table:n.table};return n.props.linkedObjects&&n.props.linkedObjects.forEach(function(e){var a=e.state,o=a.meta,r=a.data;o&&o.table.object&&(o.table.onSaveFunction||n.props.onSave)&&t.messages.push({updatedRows:e.state.updatedRows,meta:o,data:r,params:n.props.params,table:e.table})}),!!n.onSave_(t,e)},n.onSave_=function(e,t){var a=function(a){a&&e.messages.forEach(function(e){var t=e.data,n=e.meta,a=e.serverData,o=e.updatedRows,r=[];if(Object.keys(e.updatedRows).filter(function(t){return!Number.isNaN(Number(t))&&e.updatedRows[t].new_&&e.updatedRows[t].deleted_}).forEach(function(t){return r.push(e.updatedRows[t].rowUpdated.index_)}),a?a.forEach(function(e){if("deleted"===e.status_)r.push(e.index_),t||(o[e.index_].hidden_=!0);else{delete e.status_;var n=o[e.index_].rowUpdated;Object.keys(e).forEach(function(t){return n[t]=e[t]})}}):Object.values(e.updatedRows).filter(function(e){return e.deleted_}).forEach(function(e,t){r.push(e.rowUpdated.index_)}),r.length&&t&&(r.sort(function(e,t){return(e>t)-(t>e)}),r.forEach(function(e,n){return t.splice(e-n,1)})),Object.keys(e.updatedRows).forEach(function(t){return delete e.updatedRows[t]}),e.table){var i=e.table.state.filteredData;r.length&&(r.forEach(function(e){var t=i.findIndex(function(t){return t.index_===e});-1!==t&&i.splice(t,1)}),e.table.adjustScrollRows(i),e.table.updated=!1,e.table.rowUpdated=!1,e.table.tableUpdated=!1),e.table.setState({filteredDataLength:i.length})}t&&Object(B.computeData)(t,n,0)}),n.props.onSaveOk&&n.props.onSaveOk(e),t&&t(a)},o=function(t){var o=t&&n.errorHandler(e,"onSaveAfter",a);void 0!==o&&a(o)},r=function(t){var a=n.props.onSaveAfter||n.state.meta.table.onSaveAfterFunction||function(){return!0},r=t&&a(e,o);void 0!==r&&o(r)},i=function(t){var a=t&&n.errorHandler(e,"onSave",r,d);void 0!==a&&r(a)},s=function(t){var a=n.props.onSave||n.state.meta.table.onSaveFunction||function(){return!0},o=t&&a(e,i);void 0!==o&&i(o)},c=function(t){var a=t&&n.errorHandler(e,"onSaveBefore",s);void 0!==a&&s(a)},d=function(t){var o=e.updatedRows;if(!Object(w.f)(o).length)return a(!0);var r=n.props.onSaveBefore||n.state.meta.table.onSaveBeforeFunction||function(){return!0},i=t&&r(e,c);void 0!==i&&c(i)};!function(e){var t=e&&n.table.canQuit("rowQuit",d);void 0!==t&&d(t)}(!0)},n.onConfirm=function(e,t){n.setState({modalCancel:!1,modal:null,confirmationModal:!1})},n.onForeignKey=function(e,t,a,r){var i=n.state.sizes,s=i.rowHeight,c=i.zoom,d=i.height,l=i.width,u=o.a.createElement(e,{sizes:{minHeight:200,maxHeight:d,minWidth:300,maxWidth:l,rowHeight:s*c},filters:t,functions:n.props.functions}),p=n.state;p.confirmationModal=!0,p.modal={body:u,type:"foreignKey",selection:a,callback:r},n.setState({confirmationModal:!0,modal:{body:u,type:"foreignKey",selection:a,callback:r}})},n.onConflict=function(e){var a=[{id:"From",width:55}];n.state.meta.properties.forEach(function(e){return a.push(Object(f.a)({},e))});var r=Object(f.a)({},n.state.meta,{indexPk:{},table:Object(f.a)({},n.state.meta.table,{editable:!1,checkable:2,select:void 0,subscription:void 0,noFilter:!0,caption:"Conflicts resolution."}),properties:a}),i=[],s=0,c={};Object.keys(e).forEach(function(t){var n=e[t];n.server.From=n.server.deleted_?o.a.createElement("div",{style:{color:"red"}},"Server"):"Server",c[s]={checked_:!0,index_:t};var a=s;n.server.index_=a,i.push(n.server),c[s+1]={checked_:!1},i.push(Object(f.a)({},n.client,{From:n.client.deleted_?o.a.createElement("div",{style:{color:"red"}},"Client"):"Client",index_:a+1})),s+=2});var d=n.state.sizes,l=d.rowHeight,u=d.zoom,p=d.height,h=d.width;return o.a.createElement(t,{sizes:{minHeight:200,maxHeight:p,minWidth:300,maxWidth:h,rowHeight:l*u},meta:r,data:i,isModal:!0,functions:n.state.functions,updatedRows:c})},n.onResize=function(e,t){n.setState({sizes:Object(f.a)({},n.state.sizes,{height:t.size.height,width:t.size.width})})},n.getConfiguration=function(){return{sizes:Object(f.a)({},n.state.sizes,{auto:!1,minHeight:null,maxHeight:null,minWidth:null,maxWidth:null}),properties:n.state.meta.properties.reduce(function(e,t){return e[t.id]={index_:t.index_,width:t.width,locked:t.locked},e},{})}},n.state={meta:e.meta,updatedRows:e.updatedRows||{},sizes:e.sizes||{auto:!0},keyEvent:e.keyEvent,confirmationModal:!1,params:e.params||{},sorts:e.sorts||{},filters:e.filters||{},status:{loaded:!1,loading:!0}},n.state.sizes.zoom=n.state.sizes.zoom||1,n.state.sizes.rowHeight=n.state.sizes.rowHeight||25,n.state.functions=e.functions||p.j.functions([]),n.state.functions.mergeFunctionsObjects([p.h,L.b]),n.config=e.config,n.config&&n.config.sizes&&(n.state.sizes=Object(f.a)({},n.state.sizes,n.config.sizes)),n.state.data=e.data,n.getData(e),n.saveConfirmationAnswer=function(e){return e},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.data,a=e.meta,o=e.sizes,r=(e.keyEvent,e.updatedRows),i=e.filters,s=e.status,c=(e.closeRequired,e.refresh),d=e.config;if(d!==this.props.config&&(this.config=d),r&&this.props.updatedRows!==r&&this.setState({updatedRows:r}),this.props.data!==n||this.props.status!==s&&s.loaded||this.props.filters!==i&&a.table.filteredByServer||this.props.refresh!==c&&void 0!==c){this.onTableChange("refresh",function(n){if(n){if(t.props.filters!==i&&a.table.filteredByServer)t.state.filters=i;t.getData(e),t.props.linkedObjects&&t.props.linkedObjects.forEach(function(e){return e.refresh()})}})&&this.getData(e)}else this.props.sizes!==o&&this.setState({sizes:o});if(this.props.filters!==i&&this.setState({filters:i}),e.auditedRow&&e.auditedRow!==this.state.auditedRow&&(this.setState({auditedRow:e.auditedRow,audits:void 0}),e.auditedRow)){var l=this.state.meta.row.auditFunction({row:e.auditedRow,type:2,filters:e.filters});p.l.isPromise(l)?(this.setState({status:{loaded:!1,loading:!0}}),l.then(function(n){t.setState({auditedRow:e.auditedRow,audits:n||[],status:{loaded:!0,loading:!1}})})):this.setState({auditedRow:e.auditedRow,audits:l||[]})}}},{key:"render",value:function(){var e=this,t={fontSize:"".concat(100*(this.props.isModal?1:this.state.sizes.zoom),"%"),position:"relative",height:"fitContent"},n=this.state,a=n.data,r=n.meta,i=n.filters,s=n.updatedRows,c=n.sizes,d=n.status,l=n.auditedRow,u=n.audits;if(l&&u){if(r=Object(f.a)({},r,{table:Object(f.a)({},r.table,{editable:!1,noOrder:!0,actions:[],caption:"".concat(r.table.caption||r.table.object," (audit :").concat(r.row.descriptorFunction?r.row.descriptorFunction({row:l}):l.index_,")")})}),a=u,i={},s={},this.props.auditedRow)r.table.caption="".concat(r.table.caption||r.table.object);else{r.properties=[{id:"user_",caption:"User",width:80},{id:"timestamp_",caption:"Time",dataType:"number",format:"time",formatFunction:function(e){var t=e.value;return p.l.formatValue(new Date(t/1e6),"dd/mm/yyyy hh:mi:ss")},width:150,sort:"desc"},{id:"status_",caption:"Status",dataType:"string",width:70,locked:!0}].concat(Object(h.a)(r.properties.map(function(e){return Object(f.a)({},e,{locked:!1,v:void 0})}))),Object(b.c)(r,this.state.sizes.zoom),r.lockedIndex=2,r.lockedWidth=300*this.state.sizes.zoom;var m=s[l.index_];!m||!(m.deleted_||m.updated_||m.new_)||m.deleted_&&m.new_||(a=[m=Object(f.a)({},m.rowUpdated,{status_:m.deleted_?"deleted":m.new_?"inserted":"updated"})].concat(a))}c=Object(f.a)({},c),this.initSizes(r,a,c)}var g=this.props.componentId||"zebulon-table-".concat(this.props.id),v=o.a.createElement(p.d,{id:g,component:this,style:t,className:"zebulon-table",componentId:g},o.a.createElement(p.b,{key:"table-menu",getMenu:this.getMenu,componentId:g,id:"table-menu",ref:function(t){return e.contextualMenu=t}}),o.a.createElement(z,{id:this.props.id,componentId:g,style:this.props.style,status:d,data:a,meta:r,params:this.props.params,filters:i,updatedRows:s,key:this.props.id,visible:void 0===this.props.visible||this.props.visible,width:c.width,height:c.height,zoom:c.zoom,rowHeight:(this.state.sizes.rowHeight||25)*(this.state.sizes.zoom||1),caption:this.props.caption,isActive:this.props.isActive,onActivation:this.props.onActivation,ref:function(t){return e.table=t},getActions:this.props.getActions,onChange:this.props.onChange,onDoubleClick:this.props.onDoubleClick,onCellEnter:this.props.onCellEnter,onCellQuit:this.props.onCellQuit,onRowNew:this.props.onRowNew,onRowDelete:this.props.onRowDelete,onRowEnter:this.props.onRowEnter,onRowQuit:this.props.onRowQuit,onTableEnter:this.props.onTableEnter,onTableChange:this.onTableChange,onTableQuit:this.props.onTableQuit,onTableClose:this.props.onTableClose,onFilter:this.props.onFilter,onSort:this.props.onSort,select:this.props.select,onGetData:this.props.onGetData,onGetPage:this.props.onGetPage,onSave:this.onSave,onAction:this.props.onAction,callbacks:this.props.callbacks,errorHandler:this.errorHandler,navigationKeyHandler:this.props.navigationKeyHandler,contextualMenu:this.contextualMenu,callbackForeignKey:this.props.callbackForeignKey,onForeignKey:this.onForeignKey,isModal:this.props.isModal,modal:this.state.confirmationModal||this.state.modalCancel,selection:this.props.selection,scrollbarsOnBox:this.props.scrollbarsOnBox,setActions:this.props.setActions}));return(this.props.resizable||void 0===this.props.resizable)&&(v=o.a.createElement(N.ResizableBox,{width:c.width||100,height:c.height||30,onResize:this.onResize},v)),console.log("render zt",r.table,this.state.modal),o.a.createElement("div",null,v,o.a.createElement(p.a,{show:this.state.confirmationModal,detail:this.state.modal,onConfirm:this.onConfirm,ref:function(t){return e.modal=t},id:"modal-".concat(this.props.id),key:"modal-".concat(this.props.id)}))}}]),t}(g);U.prototype.getState=function(){return this.state};for(var H={table:{object:"thirdparties",select:function(e){var t=e.params,n=(e.meta,e.filters),a=Object.values(W);return n&&(a=a.filter(Object(R.a)(n,t,a))),new Promise(function(e){return e(a)})},filteredByServer:!0,primaryKey:"id",caption:"Thirdparties",actions:[{type:"insert",caption:"New",enable:!0},{type:"delete",caption:"Delete",enable:"is_selected"},{type:"duplicate",caption:"Duplicate",enable:"is_selected"},{type:"save",caption:"Save",enable:!0},{type:"refresh",caption:"Refresh",enable:!0}]},row:{audit:void 0},properties:[{id:"id",dataType:"number",mandatory:!0,hidden:!0},{id:"cd",caption:"Code",width:100,dataType:"string"},{id:"lb",caption:"Name",width:1100,dataType:"string"}]},W=[{id:4936,cd:"FRC$F",lb:"FIRST REPUBLIC BANK Depositary Shares, each representing a 1/40th interest in a share of 5.70% Noncumulative Perpetual Series F Preferred Stock"},{id:1303,cd:"GTXI",lb:"GTx, Inc. - Common Stock"},{id:4717,cd:"EVRI",lb:"Everi Holdings Inc. Common Stock"},{id:3836,cd:"CBO",lb:"CBO (Listing Market - NYSE - Networks A/E) Common Stock"},{id:905,cd:"EFUT",lb:"eFuture Holding Inc. - Ordinary Shares"},{id:1680,cd:"LIND",lb:"Lindblad Expeditions Holdings Inc.  - Common Stock"},{id:135,cd:"AMAT",lb:"Applied Materials, Inc. - Common Stock"},{id:5191,cd:"GS$I",lb:"Goldman Sachs Group, Inc. (The) Perpetual Preferred Series I"},{id:2212,cd:"PHII",lb:"PHI, Inc. - Voting Common Stock"},{id:1952,cd:"NEPT",lb:"Neptune Technologies & Bioresources Inc - Ordinary Shares"},{id:3116,cd:"ZAIS",lb:"ZAIS Group Holdings, Inc. - Class A Common Stock"},{id:162,cd:"AMTD",lb:"TD Ameritrade Holding Corporation - Common Stock"},{id:5003,cd:"GAB$D",lb:"Gabelli Equity Trust, Inc. (The) Preferred Stock Series D"},{id:3878,cd:"CEMB",lb:"iShares Emerging Markets Corporate Bond ETF"},{id:5087,cd:"GHM",lb:"Graham Corporation Common Stock"},{id:2067,cd:"OHAI",lb:"OHA Investment Corporation - Closed End Fund"},{id:4821,cd:"FEI",lb:"First Trust MLP and Energy Income Fund Common Shares of Beneficial Interest"},{id:1589,cd:"JUNO",lb:"Juno Therapeutics, Inc. - Common Stock"},{id:2168,cd:"PCCC",lb:"PC Connection, Inc. - Common Stock"},{id:4498,cd:"EFU",lb:"ProShares UltraShort MSCI EAFE"},{id:1832,cd:"MIDD",lb:"The Middleby Corporation - Common Stock"},{id:4253,cd:"DEZU",lb:"iShares Adaptive Currency Hedged MSCI Eurozone ETF"},{id:35,cd:"ACLS",lb:"Axcelis Technologies, Inc. - Common Stock"},{id:1192,cd:"FYX",lb:"First Trust Small Cap Core AlphaDEX Fund"},{id:5661,cd:"IRL",lb:"New Ireland Fund, Inc (The) Common Stock"},{id:3347,cd:"AMID",lb:"American Midstream Partners, LP Common Units representing Limited Partner Interests"},{id:2145,cd:"PACEU",lb:"Pace Holdings Corp. - Unit"},{id:2023,cd:"NVTR",lb:"Nuvectra Corporation - Common Stock"},{id:4453,cd:"ECNS",lb:"iShares MSCI China Small-Cap ETF"},{id:507,cd:"CEMI",lb:"Chembio Diagnostics, Inc. - Common Stock"},{id:2143,cd:"PACB",lb:"Pacific Biosciences of California, Inc. - Common Stock"},{id:2511,cd:"SCZ",lb:"iShares MSCI EAFE Small-Cap ETF"},{id:1882,cd:"MRTN",lb:"Marten Transport, Ltd. - Common Stock"},{id:1457,cd:"IFON",lb:"InfoSonics Corp - Common Stock"},{id:5008,cd:"GAL",lb:"SPDR SSgA Global Allocation ETF"},{id:2690,cd:"STPP",lb:"Barclays PLC - iPath US Treasury Steepener ETN"},{id:713,cd:"CTBI",lb:"Community Trust Bancorp, Inc. - Common Stock"},{id:932,cd:"EMITF",lb:"Elbit Imaging Ltd. - Ordinary Shares"},{id:4258,cd:"DFP",lb:"Flaherty & Crumrine Dynamic Preferred and Income Fund Inc. Common Stock"},{id:3357,cd:"AMT$B",lb:"American Tower Corporation (REIT) Depositary Shares, each representing a 1/10th ownership interest in a share of 5.50% Mandatory Convertible Preferred Stock, Series B"},{id:4392,cd:"DV",lb:"DeVry Education Group Inc. Common Stock"},{id:3488,cd:"AXL",lb:"American Axle & Manufacturing Holdings, Inc. Common Stock"},{id:3968,cd:"CLYH",lb:"iShares Interest Rate Hedged 10  Year Credit Bond ETF"},{id:4129,cd:"CUPM",lb:"iPath Pure Beta Copper ETN"},{id:5714,cd:"IWC",lb:"iShares Microcap ETF"},{id:3382,cd:"AON",lb:"Aon plc Class A Ordinary Shares (UK)"},{id:4952,cd:"FSTA",lb:"Fidelity MSCI COnsumer Staples Index ETF"},{id:223,cd:"ARWAR",lb:"Arowana Inc. - Rights"},{id:3419,cd:"ARL",lb:"American Realty Investors, Inc. Common Stock"},{id:4063,cd:"CRBN",lb:"iShares MSCI ACWI Low Carbon Target ETF"},{id:2070,cd:"OIIM",lb:"O2Micro International Limited - Ordinary Shares each 50 shares of which are represented by an American Depositary Share"},{id:4366,cd:"DSL",lb:"DoubleLine Income Solutions Fund Common Shares of Beneficial Interests"},{id:2078,cd:"OMAB",lb:"Grupo Aeroportuario del Centro Norte S.A.B. de C.V. - American Depositary Shares each representing 8 Series B shares"},{id:1335,cd:"HCAPL",lb:"Harvest Capital Credit Corporation - 7.00% Notes due 2020"},{id:1992,cd:"NTAP",lb:"NetApp, Inc. - Common Stock"},{id:799,cd:"DGRW",lb:"WisdomTree U.S. Quality Dividend Growth Fund"},{id:3419,cd:"ARL",lb:"American Realty Investors, Inc. Common Stock"},{id:2915,cd:"UVSP",lb:"Univest Corporation of Pennsylvania - Common Stock"},{id:1933,cd:"NBIX",lb:"Neurocrine Biosciences, Inc. - Common Stock"},{id:1934,cd:"NBN",lb:"Northeast Bancorp - Common Stock"},{id:3805,cd:"CACI",lb:"CACI International, Inc. Class A Common Stock"},{id:4925,cd:"FPT",lb:"Federated Premier Intermediate Municipal Income Fund Federated Premier Intermediate Municipal Income Fund"},{id:1932,cd:"NAVI",lb:"Navient Corporation - Common Stock"},{id:2516,cd:"SELB",lb:"Selecta Biosciences, Inc. - Common Stock"},{id:1320,cd:"HBAN",lb:"Huntington Bancshares Incorporated - Common Stock"},{id:199,cd:"ARCB",lb:"ArcBest Corporation - Common Stock"},{id:3561,cd:"BCO",lb:"Brinks Company (The) Common Stock"},{id:2072,cd:"OILU",lb:"AccuShares S&P GSCI Crude Oil Excess Return Up Shares"},{id:73,cd:"AEHR",lb:"Aehr Test Systems - Common Stock"},{id:3278,cd:"AHT$F",lb:"Ashford Hospitality Trust Inc 7.375% Series F Cumulative Preferred Stock"},{id:2109,cd:"ORLY",lb:"O'Reilly Automotive, Inc. - Common Stock"},{id:3699,cd:"BPT",lb:"BP Prudhoe Bay Royalty Trust Common Stock"},{id:3996,cd:"CNDA",lb:"IQ Canada Small Cap ETF"},{id:3966,cd:"CLX",lb:"Clorox Company (The) Common Stock"},{id:317,cd:"BELFB",lb:"Bel Fuse Inc. - Class B Common Stock"},{id:3620,cd:"BHP",lb:"BHP Billiton Limited Common Stock"},{id:3859,cd:"CCS",lb:"Century Communities, Inc. Common Stock"},{id:1300,cd:"GTIM",lb:"Good Times Restaurants Inc. - Common Stock"},{id:5573,cd:"IIM",lb:"Invesco Value Municipal Income Trust Common Stock"},{id:1202,cd:"GALTW",lb:"Galectin Therapeutics Inc. - Warrants"},{id:1993,cd:"NTCT",lb:"NetScout Systems, Inc. - Common Stock"},{id:3375,cd:"ANTX",lb:"Anthem, Inc. Corporate Units"},{id:5594,cd:"IMS",lb:"IMS Health Holdings, Inc. Common Stock"},{id:5671,cd:"ISF",lb:"ING Group, N.V. Perp Hybrid Cap Secs (Netherlands)"},{id:2082,cd:"OMEX",lb:"Odyssey Marine Exploration, Inc. - Common Stock"},{id:2215,cd:"PI",lb:"Impinj, Inc. - Common Stock"},{id:5416,cd:"HST",lb:"Host Hotels & Resorts, Inc. Common Stock"},{id:3808,cd:"CAFE",lb:"iPath Pure Beta Coffee ETN"},{id:3831,cd:"CBL",lb:"CBL & Associates Properties, Inc. Common Stock"},{id:2223,cd:"PLAY",lb:"Dave & Buster's Entertainment, Inc. - Common Stock"},{id:342,cd:"BKEPP",lb:"Blueknight Energy Partners L.P., L.L.C. - Series A Preferred Units"},{id:580,cd:"CIVB",lb:"Civista Bancshares, Inc.  - Common Stock"},{id:602,cd:"CLNT",lb:"Cleantech Solutions International, Inc. - Common Stock"},{id:393,cd:"BREW",lb:"Craft Brew Alliance, Inc. - Common Stock"},{id:5277,cd:"HCA",lb:"HCA Holdings, Inc. Common Stock"},{id:5577,cd:"IJNK",lb:"SPDR Barclays International High Yield Bond ETF"},{id:1607,cd:"KHC",lb:"The Kraft Heinz Company - Common Stock"},{id:4637,cd:"EQWL",lb:"PowerShares Russell Top 200 Equal Weight Portfolio"},{id:5711,cd:"IVW",lb:"iShares S&P 500 Growth ETF"},{id:556,cd:"CHMA",lb:"Chiasma, Inc. - Common Stock"},{id:2319,cd:"PZZA",lb:"Papa John's International, Inc. - Common Stock"},{id:1028,cd:"FCAN",lb:"First Trust Canada AlphaDEX Fund"},{id:212,cd:"ARLZ",lb:"Aralez Pharmaceuticals Inc. - Common Shares"},{id:1112,cd:"FNJN",lb:"Finjan Holdings, Inc. - Common Stock"},{id:5118,cd:"GLP",lb:"Global Partners LP Global Partners LP Common Units representing Limited Partner Interests"},{id:5617,cd:"INST",lb:"Instructure, Inc. Common Stock"},{id:3991,cd:"CMU",lb:"MFS Municipal Income Trust Common Stock"},{id:1010,cd:"FAD",lb:"First Trust Multi Cap Growth AlphaDEX Fund"},{id:164,cd:"AMWD",lb:"American Woodmark Corporation - Common Stock"},{id:1715,cd:"LONE",lb:"Lonestar Resources US Inc. - Class A Common Stock"},{id:5647,cd:"IPOS",lb:"Renaissance Capital Greenwich Fund"},{id:2385,cd:"RELL",lb:"Richardson Electronics, Ltd. - Common Stock"},{id:1375,cd:"HOFT",lb:"Hooker Furniture Corporation - Common Stock"},{id:4088,cd:"CSH",lb:"Cash America International, Inc. Common Stock"},{id:2602,cd:"SNAK",lb:"Inventure Foods, Inc. - Common Stock"},{id:1404,cd:"HTGM",lb:"HTG Molecular Diagnostics, Inc. - Common Stock"},{id:1202,cd:"GALTW",lb:"Galectin Therapeutics Inc. - Warrants"},{id:679,cd:"CREG",lb:"China Recycling Energy Corporation - Common Stock"},{id:5174,cd:"GRF",lb:"Eagle Capital Growth Fund, Inc. Common Stock"},{id:4088,cd:"CSH",lb:"Cash America International, Inc. Common Stock"},{id:4809,cd:"FDC",lb:"First Data Corporation Class A Common Stock"},{id:5493,cd:"IBMF",lb:"iShares iBonds Sep 2017 Term Muni Bond ETF"},{id:2410,cd:"RLJE",lb:"RLJ Entertainment, Inc. - Common Stock"},{id:2365,cd:"RBCN",lb:"Rubicon Technology, Inc. - Common Stock"},{id:4396,cd:"DVHI",lb:"ETRACS Diversified High Income ETN"},{id:4371,cd:"DSUM",lb:"PowerShares Chinese Yuan Dim Sum Bond Portfolio"},{id:355,cd:"BLRX",lb:"BioLineRx Ltd. - American Depositary Shares"},{id:2173,cd:"PCOM",lb:"Points International, Ltd. - Common Shares"},{id:257,cd:"ATSG",lb:"Air Transport Services Group, Inc - Common Stock"},{id:1175,cd:"FTRPR",lb:"Frontier Communications Corporation - 11.125% Series A Mandatory Convertible Preferred Stock"},{id:3806,cd:"CAE",lb:"CAE Inc. Ordinary Shares"},{id:3152,cd:"AADR",lb:"WCM BNY Mellon Focused Growth ADR ETF"},{id:3193,cd:"ADM",lb:"Archer-Daniels-Midland Company Common Stock"},{id:2314,cd:"PXS",lb:"Pyxis Tankers Inc. - Common Stock"},{id:1846,cd:"MKTX",lb:"MarketAxess Holdings, Inc. - Common Stock"},{id:441,cd:"CAPX",lb:"Elkhorn S&P 500 Capital Expenditures Portfolio"},{id:3517,cd:"BAC$L",lb:"Bank of America Corporation Non Cumulative Perpetual Conv Pfd Ser L"},{id:595,cd:"CLDX",lb:"Celldex Therapeutics, Inc. - Common Stock"},{id:330,cd:"BIDU",lb:"Baidu, Inc. - American Depositary Shares, each representing one tenth Class A ordinary share"},{id:963,cd:"ESEA",lb:"Euroseas Ltd. - Common Stock"},{id:626,cd:"CNFR",lb:"Conifer Holdings, Inc. - Common Stock"},{id:5125,cd:"GLW",lb:"Corning Incorporated Common Stock"},{id:4579,cd:"ENFR",lb:"Alerian Energy Infrastructure ETF"},{id:2253,cd:"PPH",lb:"VanEck Vectors Pharmaceutical ETF"},{id:1973,cd:"NILE",lb:"Blue Nile, Inc. - Common Stock"},{id:5454,cd:"HYI",lb:"Western Asset High Yield Defined Opportunity Fund Inc. Common Stock"},{id:1161,cd:"FSZ",lb:"First Trust Switzerland AlphaDEX Fund"},{id:2206,cd:"PFPT",lb:"Proofpoint, Inc. - Common Stock"},{id:2446,cd:"RTK",lb:"Rentech, Inc. - Common Stock"},{id:5606,cd:"ING",lb:"ING Group, N.V. Common Stock"},{id:1865,cd:"MOBL",lb:"MobileIron, Inc. - Common Stock"},{id:89,cd:"AGIIL",lb:"Argo Group International Holdings, Ltd. - 6.5% Senior Notes Due 2042"},{id:2188,cd:"PEGA",lb:"Pegasystems Inc. - Common Stock"},{id:3125,cd:"ZGNX",lb:"Zogenix, Inc. - Common Stock"},{id:5326,cd:"HEWW",lb:"iShares Currency Hedged MSCI Mexico ETF"},{id:3190,cd:"ADGE",lb:"American DG Energy Inc. Common Stock"},{id:4543,cd:"EMBB",lb:"SPDR MSCI EM Beyond BRIC ETF"},{id:2332,cd:"QLC",lb:"FlexShares US Quality Large Cap Index Fund"},{id:2348,cd:"QSII",lb:"Quality Systems, Inc. - Common Stock"},{id:3911,cd:"CHIQ",lb:"Global X China Consumer ETF"},{id:3347,cd:"AMID",lb:"American Midstream Partners, LP Common Units representing Limited Partner Interests"},{id:3106,cd:"YIN",lb:"Yintech Investment Holdings Limited - American Depositary Shares"},{id:3019,cd:"WEBK",lb:"Wellesley Bancorp, Inc. - Common Stock"},{id:1625,cd:"KOSS",lb:"Koss Corporation - Common Stock"},{id:4226,cd:"DDLS",lb:"WisdomTree Dynamic Currency Hedged International SmallCap Equity Fund"},{id:3686,cd:"BOIL",lb:"ProShares Ultra Bloomberg Natural Gas"},{id:4402,cd:"DVYE",lb:"iShares Emerging Markets Dividend Index Fund Exchange Traded Fund"},{id:1104,cd:"FMI",lb:"Foundation Medicine, Inc. - Common Stock"},{id:1011,cd:"FALC",lb:"FalconStor Software, Inc. - Common Stock"},{id:1569,cd:"JGBB",lb:"WisdomTree Japan Interest Rate Strategy Fund"},{id:3819,cd:"CAS",lb:"Castle (A.M.) & Co. Common Stock"},{id:475,cd:"CBSH",lb:"Commerce Bancshares, Inc. - Common Stock"},{id:851,cd:"DWAT",lb:"Arrow DWA Tactical ETF"},{id:1340,cd:"HCSG",lb:"Healthcare Services Group, Inc. - Common Stock"},{id:3793,cd:"C",lb:"Citigroup, Inc. Common Stock"},{id:2971,cd:"VRML",lb:"Vermillion, Inc. - Common Stock"},{id:2063,cd:"OFIX",lb:"Orthofix International N.V. - Common Stock"},{id:2730,cd:"TANNI",lb:"TravelCenters of America LLC - 8.25% Senior Notes due 2028"},{id:1258,cd:"GNTX",lb:"Gentex Corporation - Common Stock"},{id:5119,cd:"GLQ",lb:"Clough Global Equity Fund Clough Global Equity Fund Common Shares of Beneficial Interest"},{id:3750,cd:"BTA",lb:"BlackRock Long-Term Municipal Advantage Trust BlackRock Long-Term Municipal Advantage Trust Common Shares of Beneficial Interest"},{id:4215,cd:"DCUC",lb:"Dominion Resources, Inc. VA New 2014 Series A Corp Unit"},{id:3476,cd:"AVX",lb:"AVX Corporation Common Stock"},{id:5126,cd:"GM",lb:"General Motors Company Common Stock"},{id:1438,cd:"ICLDW",lb:"InterCloud Systems, Inc - Warrant"},{id:5290,cd:"HDEE",lb:"Deutsche X-trackers MSCI Emerging Markets High Dividend Yield Hedged Equity ETF"},{id:2333,cd:"QLGC",lb:"QLogic Corporation - Common Stock"},{id:5634,cd:"IPAY",lb:"PureFunds ISE Mobile Payments ETF"},{id:180,cd:"ANY",lb:"Sphere 3D Corp. - Common Shares"},{id:2823,cd:"TSBK",lb:"Timberland Bancorp, Inc. - Common Stock"},{id:2007,cd:"NUROW",lb:"NeuroMetrix, Inc. - Warrants"},{id:73,cd:"AEHR",lb:"Aehr Test Systems - Common Stock"},{id:3831,cd:"CBL",lb:"CBL & Associates Properties, Inc. Common Stock"},{id:4514,cd:"EHT",lb:"Eaton Vance High Income 2021 Target Term Trust Common Shares of Beneficial Interest"},{id:4796,cd:"FCE.B",lb:"Forest City Realty Trust, Inc. Common Stock"},{id:1997,cd:"NTIC",lb:"Northern Technologies International Corporation - Common Stock"},{id:4452,cd:"ECL",lb:"Ecolab Inc. Common Stock"},{id:4276,cd:"DHI",lb:"D.R. Horton, Inc. Common Stock"},{id:3940,cd:"CIT",lb:"CIT Group Inc (DEL) Common Stock"},{id:2396,cd:"RFEU",lb:"First Trust RiverFront Dynamic Europe ETF"}].reduce(function(e,t){return e[t.id]=t,e},{}),K=function(e){function t(){return Object(s.a)(this,t),Object(d.a)(this,Object(l.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.cloneElement(o.a.createElement(U,{key:"thirdparties",id:"thirdparties",meta:H}),Object(f.a)({},this.props))}}]),t}(a.Component),G=n(24),V=[{id:0,code:"FR",label:"France",currency_id:0,vat:.2},{id:1,code:"GB",label:"United kingdom",currency_id:1,vat:.15},{id:2,code:"US",label:"United states of America",currency_id:2,vat:.05},{id:3,code:"CA",label:"Canada",currency_id:3,vat:.12},{id:4,code:"CN",label:"China",currency_id:4,vat:.3},{id:5,code:"IT",label:"Italy",currency_id:0,vat:.15},{id:6,code:"DE",label:"Germany",currency_id:0,vat:.17},{id:7,code:"BE",label:"Belgium",currency_id:0,vat:.2},{id:8,code:"IE",label:"Ireland",currency_id:0,vat:.15},{id:9,code:"ES",label:"Spain",currency_id:0,vat:.15},{id:10,code:"NL",label:"Netherland",currency_id:0,vat:.18},{id:11,code:"JP",label:"Japan",currency_id:5,vat:.25},{id:11,code:"CH",label:"Switzerland",currency_id:6,vat:.1}].reduce(function(e,t){return t.pk_=t.id,t.caption=t.code,e[t.id]=t,e},{}),Q=function(){return V},q=[{id:0,code:"EUR",label:"Euro",symbol:"\u20ac",rate:1},{id:1,code:"GBP",label:"British pound",symbol:"\xa3",rate:.88},{id:2,code:"USD",label:"US dollar",symbol:"$",rate:1.24},{id:3,code:"CAD",label:"Canadian dollar",symbol:"ca$",rate:1.53},{id:4,code:"CNY",label:"Yuan",symbol:"cn\xa5",rate:7.81},{id:5,code:"JPY",label:"Yen",symbol:"jp\xa5",rate:136},{id:6,code:"CHF",label:"Swiss franc",symbol:"Fr.",rate:1.15}].reduce(function(e,t){return t.pk_=t.id,t.caption=t.code,e[t.id]=t,e},{}),J=function(){return new Promise(function(e){return e(q)})},X=["square","cube","rectangle","hexagon","octogon","circle","cube","disc","triangle","pyramid"],Y=["extra small","small","normal","large","extra large"],Z=["blue","yellow","red","green","cyan","magenta","orange","purple","white","pink","grey","black"],$=function(){return new Promise(function(e){return e(Z)})},ee={},te=0;te<200;te++)ee[te]={pk_:te,id:te,label:"Product ".concat(te),caption:"Product ".concat(te),shape:X[Math.ceil(Math.random()*(X.length-1.001))],size:Y[Math.ceil(Math.random()*(Y.length-1.001))],price:100*Math.random()+50,currency_id:0,currency_sym:"\u20ac"};var ne,ae=function(){return new Promise(function(e){return e(ee)})},oe=["Margote","Pollux","Z\xe9bulon","Azal\xe9e"],re={},ie={},se=function(e){e.params,e.meta,e.filters;var t=e.noJoins;ne||(ne=function(e){var t=(new Date).getTime(),n=[];re={};for(var a=Object.values(W),o=0;o<e;o++){var r={},i=a[Math.floor(Math.random()*(a.length-.001))];r.product_id=Math.floor(Math.random()*(Object.keys(ee).length-.001)),r.id=o,r.country_id=Math.floor(Math.random()*(Object.keys(V).length-.001)),r.currency_id=V[r.country_id].currency_id,r.thirdparty_id=i.id,r.thirdparty_cd=i.cd,r.color=Z[Math.floor(Math.random()*(Z.length-.001))],r.qty=Math.round(1e3*Math.random())+125,r.d=new Date(2017+Math.round(2*Math.random()),Math.round(12*Math.random()),Math.round(31*Math.random())),r.timestamp_=t-Math.round(1e6*Math.random()),n.push(r),re[o]=[{user_:oe[Math.round(4*Math.random()-1e-4)],timestamp_:t,status_:"new"}]}return{data:n,currencies:J(),countries:Q(),products:ae(),shapes:X,sizes:Y,colors:$()}}(25e3).data).forEach(function(e,t){e.product=ee[e.product_id],e.country=V[e.country_id],e.currency=q[e.currency_id],e.rowId_=t,ie[e.id]=t});var n=JSON.parse(JSON.stringify(ne.filter(function(e){return!e.deleted_})));return t&&n.forEach(function(e){delete e.product,delete e.country,delete e.currency}),console.log("array",n===ne,n.length,ne.length,n),n},ce={id:"rolling_avg",caption:"Rolling average",width:140,dataType:"number",editable:!1,hidden:!0,format:"amt_\u20ac",accessor:"amt_\u20ac",analytic:{aggregation:"avg",groupByAccessor:"row.country.id",comparisonAccessor:"row.d",sortAccessor:"row.d",windowStart:"since30d",windowEnd:function(e){return e}}},de={id:"total_amt",caption:"Total amount",width:140,dataType:"number",editable:!1,hidden:!0,format:"amt_\u20ac",accessor:"amt_\u20ac",analytic:{aggregation:"sum",groupByAccessor:"row.country.id"}},le={noCache:!1,table:{object:"dataset",caption:"dataset",actionIcons:!0,editable:!0,select:"get_array",rowId:"rowId_",onSave:"onSave",onSaveAfter:"onSaveAfter",onSaveBefore:"onSaveBefore",onTableChange:"onTableChange",filteredByServer:!0,statusDraggable:!0,noFilter:!1,noStatus:!1,noOrder:!1,actions:[{type:"insert",caption:"New",enable:!0,key:"f2",icon:S.f,toolTip:"insert new row"},{type:"delete",caption:"Delete",enable:"is_selected",key:"f3",icon:S.j,toolTip:"delete row"},{type:"duplicate",caption:"Duplicate",enable:"is_selected",key:"f4",icon:S.g,toolTip:"duplicate row"},{type:"save",caption:"Save",enable:!0,key:"f12",icon:S.i,toolTip:"save"},{type:"refresh",caption:"Refresh",enable:!0,key:"f10",icon:S.h,toolTip:"refresh"}]},row:{audit:"audit"},properties:[{id:"rowId_"},{id:"d",caption:"Date",width:100,dataType:"date",editable:!0,mandatory:!0,filterType:"between"},{id:"id",caption:"Order #",width:100,dataType:"number",mandatory:!0,editable:"is_new",filterType:"between"},{id:"product",caption:"Product",width:100,dataType:"joined object",mandatory:!0,hidden:!0,select:"getProducts",accessor:"row.product_id"},{id:"product_id",caption:"product_id",width:100,dataType:"number",hidden:!0},{id:"product_lb",caption:"Product",width:120,dataType:"string",editable:!0,filterType:"values:row.product.id",accessor:"row.product.label",sortAccessor:"product.id",locked:!0},{id:"shape",caption:"Shape",width:100,dataType:"string",editable:!1,accessor:"row.product.shape",filterType:"values"},{id:"size",caption:"Size",width:100,dataType:"string",editable:!1,accessor:"row.product.size",filterType:"values"},{id:"color",caption:"Color",width:100,dataType:"string",editable:!0,select:"getColors",filterType:"values"},{id:"price",caption:"Price",width:90,dataType:"number",editable:!1,accessor:"row.product.price",format:"price",filterType:"between"},{id:"country_id",width:100,dataType:"number",hidden:!0},{id:"country",caption:"Country",mandatory:!0,width:100,dataType:"joined object",hidden:!0,select:"getCountries",accessor:"row.country_id"},{id:"country_cd",caption:"Country",width:100,dataType:"string",editable:!0,filterType:"values",accessor:"row.country.code",onQuit:"onChangeCountry"},{id:"flag",caption:"Flag",width:40,accessor:"flag",format:"image"},{id:"currency_id",width:0,dataType:"number",hidden:!0},{id:"currency",caption:"Currency",width:0,dataType:"joined object",mandatory:!0,hidden:!0,select:"getCurrencies",accessor:"row.currency_id"},{id:"currency_cd",caption:"Currency",width:100,dataType:"string",accessor:"row.currency.code",filterType:"values",editable:!0},{id:"thirdparty_id",width:0,dataType:"number",mandatory:!0,hidden:!0},{id:"thirdparty_cd",caption:"Thirdparty",width:80,dataType:"string",filterType:"values",editable:!0,foreignObject:"thirdparties",noRefresh:!1,onChange:function(e){var t=e.value,n=e.row;n.thirdparty_id=t.id,n.thirdparty_cd=t.cd}},{id:"qty",caption:"Quantity",mandatory:!0,width:90,dataType:"number",editable:!0,filterType:"between"},{id:"bool",caption:"Boolean",width:90,dataType:"boolean",editable:!0},{id:"amt_eur",caption:"Amount in \u20ac",width:120,dataType:"number",filterType:">=",editable:!1,accessor:"amt_\u20ac",format:"amt_\u20ac"},{id:"amt",caption:"Amount",width:120,dataType:"number",editable:!1,accessor:"amt_cur",format:"amt_cur"},de,ce]},ue=function(e,t,n,a,o,r){if("updated"===n||"new"===n||"deleted"===n){var i=r.rowId_||o.rowId_;re[i]||(re[i]=[]);var s=!0,c=re[i],d={user_:e,timestamp_:t,status_:n,row:{}};"updated"===n&&(s=!1,a.forEach(function(e){Object(w.h)(r[e],o[e])||(s=!0,d.row[e]=o[e])})),s&&c.push(d)}},pe=function(e){e.params;for(var t=e.meta,n=(e.filters,e.sorts,t.properties.filter(function(e){return!e.accessor}).map(function(e){return e.id})),a=(new Date).getTime(),o=[[],[],[]],r=0;r<12;r++){var i=ne[r],s=Object(f.a)({},ne[r]);i.timestamp_=a,i.qty=Math.floor(2e3*Math.random()),ue("Z\xe9bulon",a,"updated",n,s,i),o[Math.floor(r/4)].push(Object(f.a)({},i))}return G.Observable.interval(800).take(3).map(function(e){return o[e]})},fe={onRowQuit:function(e){return e.modalBody=["Errors: "].concat(Object(w.d)(e.status,e.row.index_).map(function(t){return"\n Order# ".concat(e.row.id," : ").concat(t.error)}).concat(["Do you wan't to continue?"])),!0},onTableChange:function(e){return"sort"!==e.type&&(e.modalBody="Do you want to save before ".concat(e.type,"?")),!0},onSaveBefore:function(e){return e.modalBody=["Can't save with errors: "].concat(Object(w.c)(e.updatedRows).map(function(t){return"\nOrder# ".concat(e.updatedRows[t.rowIndex].rowUpdated.id," : ").concat(t.error)})),!(e.modalBody.length>1)&&(e.modalBody=null,!0)},onSave:function(e){return e.serverErrors?(e.modalBody=e.serverErrors,!1):(e.modalBody=null,!0)}},he={dataset:{selects:{getProducts:ae,getCountries:Q,getCurrencies:J,getColors:$},formats:{"amt_\u20ac":function(e){var t=e.value;e.row;return o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement("div",null,"\u20ac"),o.a.createElement("div",{style:{textAlign:"right"}},p.l.formatValue(t,null,2)))},amt_cur:function(e){var t=e.value,n=e.row;return o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement("div",null,(n.currency||{}).symbol),o.a.createElement("div",{style:{textAlign:"right"}},p.l.formatValue(t,null,2)))},price:function(e){var t=e.value;return o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},o.a.createElement("div",null,"\u20ac"),o.a.createElement("div",{style:{textAlign:"right"}},p.l.formatValue(t,null,2)))}},windows:{since30d:function(e){var t=new Date(e);return t.setDate(t.getDate()-30),t}},validators:{onChangeCountry:function(e){var t=e.row,n=(e.column,e.meta);return!p.l.isNullOrUndefined(t.country_id)&&p.l.isNullOrUndefined(t.currency_id)&&(t.currency_id=t.country.currency_id,t.currency=n.properties.find(function(e){return"currency"===e.id}).accessorFunction({row:t})),!0}},accessors:{qty:function(e){return e.row.qty/3},"amt_\u20ac":function(e){var t=e.row;return t.qty*(t.product||{}).price},amt_cur:function(e){var t=e.row;return t.qty*(t.product||{}).price*(t.currency||{}).rate},mth:function(e){var t=e.row;if(p.l.isNullOrUndefined(t.d))return null;var n=new Date(t.d);return n.setDate(1),n},flag:function(e){var t=e.row;return!t.country||""===t.country.code||p.l.isNullOrUndefined(t.country.code)?null:"//www.drapeauxdespays.fr/data/flags/small/".concat(t.country.code.toLowerCase(),".png")},audit:function(e){var t=e.row;return new Promise(function(e){return e((n=t.rowId_,re[n]));var n})}},actions:{computeData:v.d,toggleFilter:function(e){return e.ref.toggleFilter()}},dmls:{get_array:se,get_promise:function(e){var t=e.params,n=(e.meta,e.filters);return new Promise(function(e){var a=se({params:t,filters:n});console.log("promise",a.length,ne.length),n&&(a=a.filter(Object(R.a)(n,t,a)).map(function(e){return Object(f.a)({},e)})),e(a)})},get_observable:function(e){var t=e.params,n=(e.meta,e.filters),a=e.sorts,o=se({params:t,filters:n});a&&o.sort(Object(R.d)(a));for(var r=[],i=0;i<o.length;)r.push(o.slice(i,i+=1e3));return G.Observable.interval(20).take(r.length).map(function(e){return r[e]})},get_pagination_manager:function(e){var t=se({}),n={};t.forEach(function(e,t){e.index_="id".concat(t),n["id".concat(t)]=t});var a,o=e.filters,r=e.sorts,i=e.params,s=e.startIndex,c=e.stopIndex,d=(new Date).getTime();a=o?t.filter(Object(R.a)(o,i,t,{})):t.map(function(e){return e}),r&&a.sort(Object(R.d)(r));var l=function(e){e.length?a.sort(Object(R.d)(e)):o&&(a=t.filter(Object(R.a)(o,i,t,{})))},u=function(e){Object.keys(e).length?a=t.filter(Object(R.a)(e,i,t,{})):(a=t.map(function(e){return e}),r&&a.sort(Object(R.d)(r)))},f=function(e){var i=!1;e.updatedRows&&(i=function(e){var a,o=d;return Object(w.f)(e).forEach(function(e){if(e.timeStamp>d){var a=e.rowUpdated;if(void 0===n[a.index_])n[a.index_]=t.length,t.push(a);else{var r=t[n[a.index_]];Object.keys(a).forEach(function(e){p.l.isDate(r[e])&&"string"===typeof a[e]?r[e]=new Date(a[e]):r[e]=a[e]})}o=Math.max(o,e.timeStamp)}}),a=d!==o,d=o,a}(e.updatedRows)),e.filters?(u(e.filters),o=e.filters):i&&o&&u(o),e.sorts?(l(e.sorts),r=e.sorts):i&&r&&l(r);var f,h=a.length,m=void 0===e.startIndex?s:e.startIndex,b=void 0===e.stopIndex?c:e.stopIndex;m>=h&&(m=0),b>=100+(f=m-m%100)&&(f=Math.max(0,m-10)),f+100>=h&&(f=Math.max(0,h-100));var g=JSON.parse(JSON.stringify(a.slice(f,f+100)));return s=m,c=b,new Promise(function(e){return setTimeout(e,20)}).then(function(){return{page:g,pageStartIndex:f,pageLength:Math.min(h,100),filteredDataLength:h,dataLength:t.length}})};return new Promise(function(e){return setTimeout(e,20)}).then(function(){return f})},get_subscription:pe,onSave:function(e,t){new Promise(function(t){return t(function(e,t){var n={},a=[];Object(w.f)(e).forEach(function(e){var t=e.rowUpdated||e.row;n[t.id]||(n[t.id]={n:0,row:t}),e.row&&!n[e.row.id]&&(n[e.row.id]={n:0,row:t}),e.deleted_&&!e.new_?(n[e.row.id].n-=1,a.push({rowId_:e.row.rowId_,index_:e.row.index_})):e.updated_&&!e.new_&&e.row.id!==e.rowUpdated.id?(n[e.row.id].n-=1,n[t.id].n+=1,n[t.id].row=t):e.new_&&!e.deleted_&&(n[t.id].n+=1,n[t.id].serverIndex_=void 0,n[t.id].row=t)});var o=Object.keys(n),r=(new Date).getTime(),i=[];if(o.forEach(function(e){var t=n[e];t.n+=void 0!==ie[e],t.n>1&&i.push({index_:t.row.index_,type:"duplicate key",id:"id",caption:"Order#",error:"Order# - duplicate key: ".concat(e)})}),i.length)return{ok:!1,errors:i};var s=le.properties.filter(function(e){return!e.accessor}).map(function(e){return e.id}),c=[];return o.forEach(function(e){var a=n[e];if(1===a.n){var o=a.row.index_;delete a.row.index_,a.row.timestamp_=r,p.l.isNullOrUndefined(a.row.rowId_)?(a.row.rowId_=ne.length,ie[e]=a.row.rowId_,ue(t,r,"new",s,{},a.row),ne.push(a.row)):(ie[e]=a.row.rowId_,ue(t,r,"updated",s,ne[a.row.rowId_],a.row),ne[a.row.rowId_]=a.row),c.push({index_:o,rowId_:a.row.rowId_,timestamp_:r})}else delete ie[e]}),a.forEach(function(e){ue(t,r,"deleted",s,ne[e.rowId_],{}),ne[e.rowId_].deleted_=!0,ne[e.rowId_].timestamp_=r,c.push({index_:e.index_,rowId_:e.rowId_,timestamp_:r})}),{ok:!0,rows:c}}(JSON.parse(JSON.stringify(e.updatedRows)),e.params.user_))}).then(function(n){n.ok?(n.rows.forEach(function(t){var n=e.updatedRows[t.index_].rowUpdated;n.rowId_=t.rowId_,n.timestamp_=t.timestamp_}),e.serverErrors=void 0):e.serverErrors=["Server errors"].concat(n.errors.map(function(t){return Object(w.i)(e.updatedRows,t.index_,{id:t.id,caption:t.caption},t.type,t.error,t.rowTitle,!0),t.error})),t&&t(e)})},onSaveAfter:function(e){return!0},onSaveBefore:function(e,t){new Promise(function(t){return t(function(e){var t=[];return console.log("savebefore",ne.length),Object(w.f)(e).forEach(function(e){var n=e.rowUpdated||e.row,a=ne[n.rowId_];a&&a.timestamp_>n.timestamp_&&t.push({index_:n.index_,row:Object(f.a)({},a)})}),!t.length||t}(JSON.parse(JSON.stringify(e.updatedRows))))}).then(function(n){e.conflicts=!0!==n?n.reduce(function(t,n){var a=e.updatedRows[n.index_];return t[n.index_]={server:Object(f.a)({},n.row),client:Object(f.a)({},a.rowUpdated,{deleted_:!(!a.deleted_||a.new_)||void 0})},t},{}):void 0,t&&t(e)})}},foreignObjects:{thirdparties:K},analytics:{rolling_avg:{aggregation:"avg",groupByAccessor:"row.country.id",comparisonAccessor:"row.d",sortAccessor:"row.d",windowStart:"since30d",windowEnd:function(e){return e}},total_amt:{aggregation:"sum",groupByAccessor:"row.country.id"}}}},me=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).getLengths=function(e){e.data,e.filteredData},n.getPageLengths=function(e){var t=e.pageLength,a=e.filteredDataLength,o=e.dataLength,r=e.pageStartIndex;n.setState({dataLength:o,filteredDataLength:a,loadedDataLength:t,pageStartIndex:r})},n.handleTotalAmount=function(){de.hidden=n.state.totalAmount,de.hidden||Object(B.computeAnalytic)(n.zebulonTable.state.data,de),le.visibleIndexes=Object(B.computeMetaPositions)(le,n.zebulonTable.state.sizes.zoom),n.setState({totalAmount:!n.state.totalAmount,status:n.state.status}),n.zebulonTable.table.onMetaChange(!0)},n.handleRollingAverage=function(){ce.hidden=n.state.rollingAverage,n.setState({rollingAverage:!n.state.rollingAverage}),ce.hidden||Object(B.computeAnalytic)(n.zebulonTable.state.data,ce),le.visibleIndexes=Object(B.computeMetaPositions)(le,n.zebulonTable.state.sizes.zoom),n.setState({rollingAverage:!n.state.rollingAverage,status:n.state.status}),n.zebulonTable.table.onMetaChange(!0)},n.errorHandler={onRowQuit:function(e){return e.modalBody=["Errors: "].concat(Object(B.getRowErrors)(e.status,e.row.index_).map(function(t){return"\n Order# ".concat(e.row.id," : ").concat(t.error)}).concat(["Do you wan't to continue?"])),!0},onTableChange:function(e){return"sort"!==e.type&&(e.modalBody="Do you want to save before refresh?"),!0},onSaveBefore:function(e){return e.modalBody=["Can't save with errors: "].concat(Object(B.getErrors)(e.updatedRows).map(function(t){return"\nOrder# ".concat(e.updatedRows[t.rowIndex].rowUpdated.id," : ").concat(t.error)})),!(e.modalBody.length>1)&&(e.modalBody=null,!0)}},n.onActivation=function(e){return n.setState({activeTable:e})},n.handleRefresh=function(){n.setState({status:{loading:!0}})},n.subscribe=function(){var e=n.zebulonTable.state,t=e.meta,a=e.params,o={observableFunction:pe,observerFunctions:{onNext:L.e,onCompleted:L.c,onError:L.d}},r={dataObject:t.table.object,params:a,meta:t,filters:{},sorts:[]};n.zebulonTable.subscribe(r,o)},n.onGetData=function(){var e,t=n.state.radioDataset;"get_array"===t?e="An array is build locally and used as dataset.\nfunction: get_array @ demo/datasources.":"get_promise"===t?e="A server is simulated that returns a promise resolved as an array stored in the client.\nFilters are managed by the server.\nfunction: get_promise @ demo/datasources.":"get_observable"===t?e="A server is simulated that returns an observable.\nPages of 1000 rows are pushed by the server and loaded in background by the client .\nSorting is managed by the server to avoid visible reorders.\nfunction: get_observable @ demo/datasources.":"get_pagination_manager"===t&&(e="A server is simulated that returns a pagination manager function.\nA page of 100 rows including the start and the end row is returned as a promise at each call from the client.\nOnly the current page is stored by the client.\nSorting and filtering are managed by the server.\nfunction: get_pagination_manager @ demo/datasources."),n.setState({text:e})},n.handleRadioDataset=function(e){n.setState({config:n.config,radioDataset:e.target.value,status:{loading:!0,loaded:!1}}),n.config=n.zebulonTable.getConfiguration()},n.handleUser=function(){var e;e=n.state.userZebulon?{user_:"Pollux"}:{user_:"Z\xe9bulon",privileges_:{dataset:{table:"editable",actions:{New:"hidden",Duplicate:"hidden",Delete:"hidden"},properties:{thirdparty_cd:"hidden",qty:"visible",color:"visible",currency:"visible",d:"visible",product_lb:"visible",country_cd:"visible",id:"editable"}}},filter_:[{filterType:"values",id:"country_id",v:{2:2}}]},n.setState({userZebulon:!n.state.userZebulon,params:e,status:{loading:!0}})},n.state={sizes:{height:500,width:1300,rowHeight:25,zoom:1},status:{},sorts:{id:{id:"id",direction:"asc",sortOrder:0}},radioDataset:"get_promise",dataLength:0,filteredDataLength:0,loadedDataLength:0,meta:le,updatedRows:{},totalAmount:!1,rollingAverage:!1,confirmationModal:!1,activeTable:"dataset",closeRequired:!1,params:{user_:"Pollux"},userZebulon:!1},n.text="An array is build locally and used as dataset.\nfunction: get_array @ demo/datasources.",n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e,t,n=this,a=this.props,r=(a.keyEvent,a.functions),i=a.getComponent,s=this.state,c=s.filters,d=s.sorts,l=s.meta,u=s.dataLength,p=s.filteredDataLength,h=s.loadedDataLength,m=s.pageStartIndex,b=s.radioDataset,g=s.status,v=s.activeTable,w=s.params;Object(f.a)({},this.props.sizes);l.serverPagination="get_pagination_manager"===b,l.table.select=b,this.previousState=this.state,e=o.a.createElement("div",null,o.a.createElement("div",{style:{display:"block",padding:5,height:50,boxSizing:"border-box"}},"Dummy dataset with 5 joined tables: orders (date,#,color,quantitiy), products(id, shape, size, price), countries (id, code), currencies (id, code, symbol, rate) and thirdparties (id,code). Thirdparties are managed with a foreign key controlled by an other zebulon table component."),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("div",{style:{display:"block",padding:5,height:170,boxSizing:"border-box"}},o.a.createElement("div",{style:{display:"flex",width:670}},"Dataset is generated as",o.a.createElement("input",{type:"radio",id:"radioArray",name:"radioDataset",value:"get_array",checked:"get_array"===b,onChange:this.handleRadioDataset}),o.a.createElement("div",null,"an array "),o.a.createElement("input",{type:"radio",id:"radioPromise",name:"radioDataset",value:"get_promise",checked:"get_promise"===b,onChange:this.handleRadioDataset}),o.a.createElement("div",null," a promise or "),o.a.createElement("input",{type:"radio",id:"radioObservable",name:"radioDataset",value:"get_observable",checked:"get_observable"===b,onChange:this.handleRadioDataset}),o.a.createElement("div",null," an observable ")),o.a.createElement("div",null,"Dataset length : ".concat(u,", filtered : ").concat(p,", loaded :  ").concat(h," ").concat(void 0!==m?", page start at "+String(m):"",".")),o.a.createElement("div",{style:{marginTop:5}},"Amount and Amount in \u20ac are computed on the fly as quantity*price and quantity*price*rate."),o.a.createElement("div",{style:{marginTop:5}},"Rolling amount and Total amount are computed initially then on demand as :"),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("input",{type:"checkbox",disabled:"get_pagination_manager"===this.state.radioDataset,checked:this.state.rollingAverage&&"get_pagination_manager"!==this.state.radioDataset,onChange:this.handleRollingAverage}),"rolling average of amounts in \u20ac order by date since 30 days."),o.a.createElement("div",{style:{display:"flex"}},o.a.createElement("input",{type:"checkbox",disabled:"get_pagination_manager"===this.state.radioDataset,checked:this.state.totalAmount&&"get_pagination_manager"!==this.state.radioDataset,onChange:this.handleTotalAmount}),"sum of amounts in \u20ac by country."),o.a.createElement("div",{style:{display:"flex",marginTop:10,height:30}},o.a.createElement("input",{type:"checkbox",checked:this.state.userZebulon,onChange:this.handleUser}),"Connect with a restricted user only allowed to update # of US orders,thirdparty hidden.")),o.a.createElement("div",{style:{display:"block"}},o.a.createElement("textarea",{readOnly:!0,rows:"6",cols:"120",value:this.state.text,style:{fontFamily:"sans-serif",border:"unset",fontSize:"medium",color:"blue",marginLeft:30}}),o.a.createElement("button",{onClick:this.subscribe,style:{marginTop:15,marginLeft:30}},"Subscription to three server events updating the quantity of the 12th (by four) first rows by order#"))));return t=o.a.createElement("div",{style:{marginTop:10,marginLeft:2}},o.a.createElement("textarea",{readOnly:!0,rows:"20",cols:"180",value:"Test key, navigation, zoom, scroll, wheel, accelerators...\n\u2022 resize the grid using the handle at right, down corner. \n\u2022 ctrl +, ctrl - for zoom in zoom out.\n\u2022 ctrl A to select all.\n\u2022 F2 New,F3 Duplicate,F4 Delete,F10 Refresh, F11 toggle from/to filters bar, F12 Save.\n\u2022 shift to extend the selection,\n\u2022 left and right arrows to select previous or next cell in the row,\n\u2022 up and down arrows to select the same cell in previous or next row,\n\u2022 page up and page down to select the same cell at previous or next page,\n\u2022 alt + page up or page down to select on the same row the on previous next, page,\n\u2022 home and end to select the cell on the first or last row,\n\u2022 alt + home or end to select the first or last cell on the row,\nIn an editable cell, left and right arrow must keep the default behaviour .\n\u2022 Alt key is used to force the navigation.\n\nUpdate editable columns\n\u2022 update a product -> linked columns from product object are updated.\n\u2022 update a quantity -> computed columns (amounts) are updated.\n\u2022 update a thirdparty, enter 'a' then quit the cell to select one in the thirdparties beginning by 'a'.\n\u2022 update a date to null -> check the status bar tooltip after row change.\n\u2022 copy paste from excel (ctrl + C to copy selected  range, ctrl + V to paste from the focused cell. Only editables cells are updates. All validations are done.\n\nTry filters, sorts...\n\u2022 Click on a column will toggle the sort direction from none to ascending then descending. The column is added to columns allready sorted (multisort). Reset multisort by double click.\n\u2022 Lock and unlock columns with the contectual menu on column headers (right click). \n\u2022 Test 'between filters' (date, quantity...), 'values filters' (product, thirdparties..., 'starts filters' (order).\n\u2022 Test 'status filters' : right click on top left status cells.\n\u2022 Test 'ctrl f' to search values in the grid.\n\u2022 Resize and move columns by drag and drop.\n\u2022 Test conflict resolution by updatating rows in the 10 first rows by order#, subscribe to a server event then save.\n\u2022 Test the 'audit' functionality : right click on status cell on an updated and saved rows (exit of audit by right click on top left status cells).\n\u2022 Test privileges management with the 'Connect with a restricted user' check box  ...",style:{fontFamily:"sans-serif",border:"unset"}})),o.a.createElement("div",{style:{fontFamily:"sans-serif"},id:"zebulon"},e,o.a.createElement(U,{id:"dataset",style:{border:"solid grey 0.06em"},meta:l,params:w,filters:c,sorts:d,status:g,sizes:this.state.sizes,functions:r,errorHandler:fe,onFilter:this.getLengths,onGetPage:this.getPageLengths,ref:function(e){return n.zebulonTable=e},isActive:"dataset"===v,onActivation:function(){return n.onActivation("dataset")},getComponent:i,config:this.state.config,onGetData:this.onGetData,scrollbarsOnBox:this.props.scrollbarsOnBox}),t)}}]),t}(a.Component),be=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).initTabsState=function(e,t,a){return t.tabs&&t.tabs.forEach(function(o,r){void 0===o.props&&(o.props={}),o.selected&&e.selectedTab!==r+3&&(e.selectedTab=r+3),!a&&n.props.tabs&&n.props.tabs[r]&&n.props.tabs[r].id===o.id&&o.data===n.props.tabs[r].data||(o.props.functions&&e.functions.mergeFunctionsObjects(o.props.functions),e[o.id]=o.data,e["".concat(o.id,"Meta")]=o.meta||n.metaDescriptions[o.id],e["".concat(o.id,"Meta")]&&(Object(B.computeMetaFromData)(e[o.id],e["".concat(o.id,"Meta")],t.sizes.zoom,e.functions),e["".concat(o.id,"UpdatedRows")]=o.updatedRows))}),e},n.initMeta=function(e,t,n,a,o){if(!e.table){var r=Object(L.a)("dataset",void 0,a,t).dataset;e.table=r.table,e.row=r.row,e.properties=r.properties}n&&Array.isArray(n)&&n.length&&e.properties&&(0===e.properties.length&&Object(B.computeMetaFromData)(n,e,o,a),Object(L.f)(e.properties,n))},n.handleKeyEvent=function(e){var t=n.tabs[n.state.selectedTab].id;if(n[t]&&n[t].handleKeyEvent)return n[t].handleKeyEvent(e)},n.onChangeProperties=function(e){var t=e.value,a=e.previousValue,o=e.column,r=e.row;["select","dataType"].includes(o.id)&&t!==a&&[t,a,r.dataType].includes("joined object")&&(n.changedProperties=!0)},n.onRowDelete=function(e){var t=e.row,a=e.status;t.deleted_=a.deleted_,n.changedProperties=!0},n.onRowNew=function(e){n.changedProperties=!0},n.onGetData=function(e){var t=e.data,a=e.meta;e.status;if(t&&"dataset"===a.table.object&&n.changedProperties){var o=n.state,r=o.functions,i=o.sizes;n.changedProperties=!1,n.initMeta(a,n.state.callbacks,t,r,i.zoom)}return!0},n.applyFunctions=function(e){var t=e.updatedRows,a=n.state.functions;return Object(B.getUpdatedRows)(t).filter(function(e){return(e.row||{}).isLocal||(e.rowUpdated||{}).isLocal}).forEach(function(e){e.rowUpdated||e.row;e.row&&a.removeFunction(e.row.visibility,e.row.tp,e.row.id),e.rowUpdated&&a.setInitialFunction(e.rowUpdated.visibility,e.rowUpdated.tp,e.rowUpdated.id,e.rowUpdated.caption,e.rowUpdated.functionText)}),Object(B.computeMeta)(n.state.meta,n.zoomValue,n.state.functions),!0},n.applyProperties=function(e){var t=e.data,a=n.state.meta;return Object(B.computeMeta)(Object(f.a)({},a,{properties:t}),n.zoomValue,n.state.functions),a.properties=t.map(function(e){return Object(f.a)({},e)}),-1!==a.properties.findIndex(function(e){var t=Object(B.getRowStatus)(n.state.propertiesUpdatedRows,e);return"joined object"===e.dataType&&void 0!==e.accessor&&void 0!==e.select&&(t.new_||t.updated_&&(t.row.accessor!==t.rowUpdated.accessor||t.row.select!==t.rowUpdated.select||"joined object"!==t.row.dataType))})&&(Object(B.computeData)(n.state.data,a),Object(L.f)(a.properties,n.state.data)),a.properties.filter(function(e){var t=Object(B.getRowStatus)(n.state.propertiesUpdatedRows,e);return(e.aggregation||e.analytic)&&"function"===typeof e.accessorFunction&&!e.hidden&&(t.new_||t.updated_&&(t.row.accessor!==t.rowUpdated.accessor||t.row.analytic!==t.rowUpdated.analytic))}).forEach(function(e){Object(B.computeAnalytic)(n.state.data,e)}),!0},n.setActions=function(e,t){t&&(console.log("actions",e,t),n.tabs[e].actions=t,n.setState({selectedTab:n.state.selectedTab}))},n.initTabs=function(e,t){var a=t.params,r=t.utils,i=t.configurationMenus,s=t.id,c=t.navigationKeyHandler,d=t.errorHandler,l=(e.selectedTab,e.data),u=e.meta,p=e.filters,f=e.updatedRows,b=e.functions,g=e.status,v=e.functionUpdatedRows,w=e.functionsMeta,y=e.functionsData,C=e.propertiesMeta,S=e.propertiesUpdatedRows,k=i||{};return n.tabs=[{id:"dataset",caption:"Dataset",index:0,content:o.a.createElement(U,{key:0,id:"".concat(s,"-dataset"),data:l,meta:u,filters:p,updatedRows:f,functions:b,params:a,keyEvent:null,onTableEnter:n.onTableEnter,ref:function(e){return n.dataset=e},errorHandler:d,navigationKeyHandler:c,onGetData:n.onGetData,resizable:!1,utils:r,contextualMenu:k.dataset?k.dataset(Object(m.a)(Object(m.a)(n))):void 0,scrollbarsOnBox:n.props.scrollbarsOnBox,setActions:function(e){return n.setActions(0,e)}})},{id:"properties",caption:"Properties",index:1,content:o.a.createElement(U,{key:1,id:"".concat(s,"-properties"),data:Object(h.a)(u.properties),meta:C,updatedRows:S,onChange:n.onChangeProperties,onRowDelete:n.onRowDelete,onRowNew:n.onRowNew,functions:b,status:g,params:a,keyEvent:null,ref:function(e){return n.properties=e},errorHandler:{},utils:r,resizable:!1,contextualMenu:k.properties?k.properties(Object(m.a)(Object(m.a)(n))):void 0,scrollbarsOnBox:n.props.scrollbarsOnBox,setActions:function(e){return n.setActions(1,e)}})},{id:"functions",caption:"Functions",index:2,content:o.a.createElement(U,{key:2,id:"".concat(s,"-functions"),data:y,meta:w,updatedRows:v,functions:b,params:a,keyEvent:null,ref:function(e){return n.functions=e},errorHandler:{},utils:r,resizable:!1,contextualMenu:k.functions?k.functions(Object(m.a)(Object(m.a)(n))):void 0,scrollbarsOnBox:n.props.scrollbarsOnBox,setActions:function(e){return n.setActions(2,e)}})}],n.initTabProps(e,t),n.tabs},n.initTabProps=function(e,t){e.selectedTab;var a=e.sizes,r=t.params,i=t.utils,s=t.id,c=t.configurationMenus||{};t.tabs&&t.tabs.forEach(function(t,d){if(t!==n.tabs[3+d]){var l=t.content?t.content:U;n.tabs[3+d]={id:t.id,caption:t.caption,props:t.props,index:3+d,content:o.a.createElement(l,{key:3+d,id:"".concat(s,"-").concat(t.id),data:e[t.id],meta:e["".concat(t.id,"Meta")],updatedRows:e["".concat(t.id,"UpdatedRows")],sizes:a,functions:e.functions,params:r,keyEvent:null,ref:function(e){return n[t.id]=e},errorHandler:{},utils:i,contextualMenu:c[t.id]?c[t.id](Object(m.a)(Object(m.a)(n))):void 0,scrollbarsOnBox:n.props.scrollbarsOnBox,setActions:function(e){return n.setActions(3+d,e)}})}}}),n.tabs.length>3+(t.tabs||[]).length&&n.tabs.splice(3+(t.tabs||[]).length,n.tabs.length-3)},n.onSelectTab=function(e){var t=n.state.selectedTab,a=n[n.tabs[t].id].table?n[n.tabs[t].id].table.canQuit:null;a?a("quit",function(t){t&&n.setState({selectedTab:e})}):n.setState({selectedTab:e})};var a=e.functions;a.mergeFunctionsObjects([p.h,L.b]),a.composeFunction("dataset","actions","exportMeta",a.getFunctionsObject());var r=e.meta;n.initMeta(e.meta,e.callbacks,e.data,a,e.sizes.zoom),Object(B.computeMetaFromData)(e.data,r,e.sizes.zoom,a);var i={selectedTab:e.selectedTab||0,data:e.data,meta:r,updatedRows:e.updatedRows||{},propertiesUpdatedRows:{},functionsUpdatedRows:{},functions:a,functionsData:a.getFunctionsArray((r.table||{}).object||"dataset",void 0,(r.table||{}).source),sizes:e.sizes,filters:e.filters,status:{},callbacks:Object(f.a)({applyFunctions:n.applyFunctions,applyProperties:n.applyProperties},e.callbacks||{})};return n.zoomValue=e.sizes.zoom||1,n.metaDescriptions=Object(L.a)((r.table||{}).object||"dataset",(r.table||{}).source,i.functions,i.callbacks),r.table.actions=n.metaDescriptions.dataset.table.actions,i.propertiesMeta=n.metaDescriptions.properties,Object(B.computeMeta)(i.propertiesMeta,e.sizes.zoom,i.functions),i.functionsProperties=a,i.functionsMeta=n.metaDescriptions.functions,Object(B.computeMeta)(i.functionsMeta,e.sizes.zoom,i.functions),i.functionsFunctions=a,n.initTabsState(i,e,!0),n.initTabs(i,e),n.state=i,n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t={};e.keyEvent!==this.props.keyEvent?this.handleKeyEvent(e.keyEvent):(e.data===this.props.data&&e.meta===this.props.meta&&e.filters===this.props.filters||(this.initMeta(e.meta,this.state.callbacks,e.data,this.state.functions,e.sizes.zoom),t={data:e.data,meta:e.meta,functions:this.state.functions,filters:e.filters}),e.updatedRows&&e.updatedRows!==this.props.updatedRows&&(t.updatedRows=e.updatedRows),e.sizes!==this.props.sizes&&(t.sizes=e.sizes),e.tabs&&(t=this.initTabsState(t,e)),this.setState(t),this.initTabProps(Object(f.a)({},this.state,t),e))}},{key:"shouldComponentUpdate",value:function(e,t){return e.keyEvent===this.props.keyEvent}},{key:"render",value:function(){var e=this;if(this.props.status.loading||this.props.status.loadingConfig)return o.a.createElement("div",null,"Loading data...");if(this.props.status.error&&"No rows retrieved"!==this.props.status.error.message)return o.a.createElement("div",{style:{color:"red",width:"max-content"}},o.a.createElement("p",null,this.props.status.error.type),o.a.createElement("p",null,this.props.status.error.message));var t=this.zoomValue;return o.a.createElement("div",null,o.a.createElement("div",{style:{display:"flex",height:25*t},className:"zebulon-tabs-list"},this.tabs.map(function(t,n){return o.a.createElement("div",{key:n,style:{width:"".concat((100/e.tabs.length).toFixed(2),"%")},className:C()({"zebulon-tabs-tab":!0,"zebulon-tabs-tab-selected":n===e.state.selectedTab}),onClick:function(){return e.onSelectTab(n)}},t.actions?o.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:"bold",textAlign:"center"}},o.a.createElement("div",{style:{textAlign:"center",width:"100%"}},t.caption),t.actions):t.caption)})),o.a.createElement("div",{style:{height:this.props.sizes.height-30*t}},this.tabs.map(function(t){return o.a.cloneElement(t.content,Object(f.a)({},t.props,{visible:t.index===e.state.selectedTab,isActive:t.index===e.state.selectedTab,sizes:e.state.sizes}))})))}}]),t}(a.Component),ge=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).onResize=function(e,t){n.setState({sizes:Object(f.a)({},n.state.sizes,{height:t.size.height,width:t.size.width})})};var a=Object(f.a)({},le);a.table=Object(f.a)({},a.table),a.table.actions=[].concat(Object(h.a)(a.table.actions),[{type:"action",caption:"Export Meta",enable:!0,hidden:!0,action:"exportMeta"}]),a.properties=[],a.lockedIndex=null,a.lockedWidth=null;var o=se({noJoins:!0});return n.state={status:{},data:o,meta:a,params:{user_:"Zebulon"},sizes:{height:500,width:1300,rowHeight:25,zoom:1}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.keyEvent,n=e.functions,a=e.id,r=this.state,i=r.data,s=r.meta,c=r.status,d=r.params;return o.a.createElement("div",null,o.a.createElement(N.ResizableBox,{height:this.state.sizes.height,width:this.state.sizes.width,onResize:this.onResize},o.a.createElement(be,{id:a,functions:n,params:d,data:i,meta:s,status:c,sizes:Object(f.a)({},this.state.sizes,{height:this.state.sizes.height-30}),keyEvent:t,scrollbarsOnBox:this.props.scrollbarsOnBox})),o.a.createElement("div",{style:{fontFamily:"sans-serif",border:"unset",paddingTop:50,fontWeight:"bold"}},"Create the configuration from the original dataset as in the 'Dataset and server' tab."),o.a.createElement("textarea",{readOnly:!0,rows:"25",cols:"180",value:"Dataset row object:{d:<date>,id:<number>,product_id:<number>,currency_id:<number>,country_id:<number>,qty:<number>,color:<string>,thirdparty:{id:<number>,cd:<string>,lb:<string>}}.\nProduct object:{id:<number>,label:<string>,price:<number>,shape:<string>,size:<string>}.\nCurrency object:{id:<number>,code:<string>,label:<string>,symbol:<string>rate:<number>}.\nCountry object:{id:<number>,code:<string>,label:<string>,currency_id:<number>,vat:<number>}.\nN.B. Accessors, formats...exists allready.\n\nOn the Properties tab.\nJoined the objects products, countries, currencies:\n\u2022 create 3 new properties (product, country, currency) with \n  \u2022 type = joined object.\n  \u2022 accessor = respectively row.product_id, row.country_id, row.currency_id.\n  \u2022 select = respectively getProducts, getCountries, currencies.Apply changes on the dataset (apply button) to load the instances of the objects, new accessors on objects keys won't be accessible otherwise.\n\nOn the Dataset tab.\n\nOn the Properties tab.\nCreate the 4 new properties for products:\n\u2022 product_cd, data type = string, editable = true, accessor = row.product.label (only the properties used for the select Input must be editable)\n\u2022 price, data type = number, editable = false, accessor = row.product.price\n\u2022 shape, data type = string, editable = false, accessor = row.product.shape\n\u2022 size, data type = string, editable = false, accessor = row.product.size\nSet the price format to price property,\nCreate the 2 new properties for countries:\n\u2022 country_cd, data type = string, editable = true, accessor = row.country.code (only the properties used for the select Input must be editable)\n\u2022 flag, editable = false, accessor = flag, format = image, width = 40\nCreate the new property for currencies:\n\u2022 currency_cd, data type = string, editable = true, accessor = row.currency.code (only the properties used for the select Input must be editable)\nCreate the new property for thirdparties foreign table object:\n\u2022 thirdparty_cd, data type = string, editable = true, accessor = row.thirdparty.cd, foreign object = thirdparties\nSet row color select = getColors, data type = string.\nCreate a new property:\n\u2022 code = month, data type = date, format = mm/yyyy, accessor = mth, filter = values\nHide the ids (product, currency, country).\nCreate the 2 calculated properties \n\u2022 amount, data type = number, editable =  false, format = amt_cur, accessor = amt_cur, width = 150\n\u2022 amountEUR, data type = number, editable =  false, format = amt_\u20ac, accessor = amt_\u20ac, width = 150.\nApply changes and check on the Dataset tab\n\nOn the Functions tab.\nCreate a new accessor: gross_amount.\n\u2022 code = gross_amt.\n\u2022 visibility = dataset.\n\u2022 type = accessor.\n\u2022 function = ({row})=>accessor('amt_cur')({row})*(1+(row.country||{vat:0}).vat).\nN.B. The accessor function let you use an other accessor in your function.\nApply changes and check on the Dataset tab.\n\nOn the Properties tab.\nCreate a new property:\n\u2022 code = gross_amt.\n\u2022 format = amt_cur.\n\u2022 accessor = gross_amt.\nCreate the 2 new properties calculated by analytics functions:\n\u2022 code = totalAmountByCountry, data type = number, accessor = totalAmt, analytic function = total_amt.\n\u2022 code = rollingAverage, data type = number, accessor = amt_cur, analytic function = rolling_avg.\nApply changes and check on the Dataset tab. \n\nAdd an init function to set country currency by default when country changes and currency is null (country_cd/onChange = onChangeCountry).\nRename the columns (caption column).\nSet the appropriate filter type on the properties..\nApply changes and check on the Dataset tab.\n.\nTest the result on the Dataset tab.",style:{fontFamily:"sans-serif",border:"unset",paddingTop:10}}))}}]),t}(a.Component),ve=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(d.a)(this,Object(l.a)(t).call(this,e))).handleKeyEvent=function(e){return n.setState({keyEvent:e}),!0},n.errorHandler={onRowQuit:function(e){return window.confirm(JSON.stringify(e.status))}},n.onSelectTab=function(e){1===e&&n.component&&n.component.onClose?n.component.onClose(function(t){t&&n.setState({selectedTab:e})}):n.setState({selectedTab:e})},n.tabs=[{id:"dataset",caption:"Dataset and server"},{id:"selfConfig",caption:"Manage configuration",disabled:!0}],n.getTabContent=function(e){var t=n.state,a=t.keyEvent,r=t.functions;return 0===e?o.a.createElement(me,{id:"dataset",functions:r,keyEvent:a,getComponent:function(e){return n.component=e},scrollbarsOnBox:!0}):1===e?o.a.createElement(ge,{id:"dataset",functions:r,keyEvent:a,scrollbarsOnBox:!0}):void 0},n.options=[200,40,3],n.state={data:null,keyEvent:null,functions:p.j.functions(he),updatedRows:{},params:{},status:{},filters:{qty:{id:"qty",filterType:"between",v:123,vTo:256}},sorts:{d:{id:"d",direction:"asc",sortOrder:0},toto:{id:"toto",direction:"desc",sortOrder:1}},selectedTab:0,radioDataset:"get_array",dataLength:0,filteredDataLength:0,loadedDataLength:0},n.state.functions.setVisibility("dataset"),n.text="\nAn array is build locally and used as dataset.\nfunction: get_array @ demo/datasources.",n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){document.addEventListener("copy",this.handleKeyEvent),document.addEventListener("paste",this.handleKeyEvent),document.addEventListener("keydown",this.handleKeyEvent)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("copy",this.handleKeyEvent),document.removeEventListener("paste",this.handleKeyEvent),document.removeEventListener("keydown",this.handleKeyEvent)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{style:{fontSize:"".concat(100,"%"),fontFamily:"sans-serif",width:1300}},o.a.createElement("div",{style:{display:"flex",height:25},className:"zebulon-tabs-list"},this.tabs.map(function(t,n){return o.a.createElement("div",{key:n,style:{width:"50%"},className:C()({"zebulon-tabs-tab":!0,"zebulon-tabs-tab-selected":n===e.state.selectedTab}),onClick:function(){return e.onSelectTab(n)}},t.caption)})),o.a.createElement("div",null,this.getTabContent(this.state.selectedTab)),o.a.createElement("div",{style:{height:55,width:200,border:"solid",position:"relative",overflow:"hidden"},onScroll:function(e){return console.log("scroll",e)}},o.a.createElement("input",{type:"text"}),o.a.createElement("input",{type:"text"}),o.a.createElement(p.f,{id:-12345,style:{width:100,height:25,boxSizing:"border-box",textAlign:"center"},dataType:"date",value:new Date,editable:!0,onScroll:function(e){return console.log(e)},hasFocus:"true"})))}}]),t}(a.Component);i.a.render(o.a.createElement(ve,null),document.getElementById("root"))}},[[32,2,1]]]);
//# sourceMappingURL=main.fdf69439.chunk.js.map